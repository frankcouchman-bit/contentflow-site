<!doctype html>
<html lang="en" class="h-full">
<head>
  <!-- Google Ads / gtag -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17511593434"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'AW-17511593434');
  </script>

  <!-- Core meta -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ContentRepurpose.pro — AI Content Repurposing Software for LinkedIn, X (Twitter), Instagram, TikTok, Reddit, Facebook, Quora + Article Optimizer, Scheduler & Analytics</title>
  <meta name="description" content="Paste a URL, blog, or idea and instantly generate platform-perfect posts for LinkedIn, X, Instagram, TikTok, Reddit, Facebook, Quora and Email. Includes Article Optimizer, per-platform Optimize actions, Scheduler, and lightweight Analytics. BYOK supported." />
  <link rel="canonical" href="https://contentrepurpose.pro/">
  <meta name="robots" content="index,follow,max-image-preview:large,max-snippet:-1,max-video-preview:-1" />
  <meta name="theme-color" content="#0a0d18">
  <meta name="color-scheme" content="dark light">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="ContentRepurpose.pro — Paste once. Publish everywhere.">
  <meta property="og:description" content="AI content repurposing across LinkedIn, X, Instagram, TikTok, Reddit, Facebook, Quora + Article Optimizer, Scheduler & Analytics." />
  <meta property="og:image" content="/og-cover.png">
  <meta property="og:url" content="https://contentrepurpose.pro/">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="ContentRepurpose.pro — AI Content Repurposing">
  <meta name="twitter:description" content="Turn any URL or idea into platform-perfect content.">
  <meta name="twitter:image" content="/og-cover.png">

  <!-- (Optional, not used by rankings but harmless) -->
  <meta name="keywords" content="content repurposing, ai content repurposing, linkedin post generator, twitter thread generator, instagram caption generator, tiktok script generator, reddit post generator, quora answer generator, email newsletter generator, article optimizer, ai social media tool, content scheduler, content analytics, byok openrouter" />

  <!-- Preconnects -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- Fonts & CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Charts (Analytics panel later) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>

  <!-- Global App Config (plans, platforms, misc settings) -->
  <script>
    // Updated to reflect your funnel: 5/mo demo (IP), Free 5/day, paid tiers higher caps.
    window.APP_CONFIG = {
      demo: { monthlyLimit: 5, upsellAfter: 2 }, // show upsell after 2 demo runs
      plans: {
        Free:     { platformDaily: 5,  byokDaily: 5,   scheduler: false, analytics: false },
        Starter:  { platformDaily: 25, byokDaily: 100, scheduler: true,  analytics: true  },
        Creator:  { platformDaily: 50, byokDaily: 300, scheduler: true,  analytics: true  },
        Business: { platformDaily: 100, byokDaily: Infinity, scheduler: true, analytics: true }
      },
      platforms: [
        { key:"linkedin", label:"LinkedIn",  icon:"#i-li" },
        { key:"x",        label:"X (Twitter)", icon:"#i-x" },
        { key:"email",    label:"Email",     icon:"#i-mail" },
        { key:"instagram",label:"Instagram", icon:"#i-ig" },
        { key:"tiktok",   label:"TikTok",    icon:"#i-tt" },
        { key:"reddit",   label:"Reddit",    icon:"#i-reddit" },
        { key:"facebook", label:"Facebook",  icon:"#i-fb" },
        { key:"quora",    label:"Quora",     icon:"#i-quora" },
        { key:"li-article", label:"LinkedIn Article", icon:"#i-li" }
      ],
      pixels: { meta:"", tiktok:"", quora:"" }
    };

    // UTM + simple session id for light attribution
    (function(){
      try{
        const p=new URLSearchParams(location.search);
        const utm=['utm_source','utm_medium','utm_campaign','utm_term','utm_content'].reduce((o,k)=>(p.get(k)&&(o[k]=p.get(k))),{});
        if(Object.keys(utm).length){ localStorage.setItem('first_touch_utm', JSON.stringify(utm)); }
        if(!localStorage.getItem('session_id')) localStorage.setItem('session_id','sess_'+Math.random().toString(36).slice(2));
      }catch(e){}
    })();
  </script>

  <!-- Base styles -->
  <style>
    :root{
      --brandA:#7AA2FF; --brandB:#FF2D2D; --ink:#0a0d18; --ink-2:#101425; --ring:rgba(122,162,255,.28);
    }
    html,body{font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    .txt-grad{background:linear-gradient(135deg,var(--brandA),var(--brandB));-webkit-background-clip:text;background-clip:text;color:transparent}
    .bg-grad{background:linear-gradient(135deg,var(--brandA),var(--brandB))}
    .card{border-radius:1.25rem;border:1px solid rgba(15,23,42,.10);background:rgba(255,255,255,.80);box-shadow:0 12px 40px rgba(2,6,23,.08)}
    .btn{padding:.65rem .95rem;border-radius:.9rem;border:1px solid rgba(148,163,184,.35)}
    .btn-primary{background:#0b0f1c;color:#fff}
    .chip{font-size:.72rem;padding:.22rem .52rem;border-radius:9999px;border:1px solid rgba(148,163,184,.35)}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
    .member-only{display:none!important;}
    [data-auth="member"] .guest-only{display:none!important;}
    [data-auth="member"] .member-only{display:initial!important;}
    .halo{position:absolute;filter:blur(60px);opacity:.55;pointer-events:none;transform:translateZ(0);
      background:radial-gradient(50% 50% at 50% 50%, rgba(122,162,255,.8), rgba(255,45,45,.65) 60%, transparent 70%);
      width:42rem;height:42rem;border-radius:50%;animation:float 16s ease-in-out infinite}
    .halo.h2{width:34rem;height:34rem;left:auto;right:-12rem;top:-6rem;animation-duration:18s;opacity:.5}
    .halo.h3{width:28rem;height:28rem;left:-10rem;top:26rem;animation-duration:22s;opacity:.45}
    @keyframes float{0%,100%{transform:translate3d(0,0,0)}50%{transform:translate3d(0,-20px,0)}}
    .orbit{position:absolute;inset:-32px;border-radius:24px;pointer-events:none;
      background:conic-gradient(from 0deg, rgba(122,162,255,.25), rgba(255,45,45,.18), rgba(122,162,255,.25));
      -webkit-mask:radial-gradient(closest-side,transparent 88%, black 89%);mask:radial-gradient(closest-side,transparent 88%, black 89%);
      animation:spin 18s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    .mock{border-radius:1rem;border:1px solid rgba(255,255,255,.12);
      background:linear-gradient(180deg,rgba(255,255,255,.75),rgba(255,255,255,.6))}
    @media (prefers-color-scheme:dark){.mock{background:linear-gradient(180deg,rgba(17,20,31,.88),rgba(17,20,31,.72))}
      body{background:var(--ink);color:#e9eef6}
      .card{background:rgba(14,16,22,.6);border-color:rgba(255,255,255,.08);
        box-shadow:0 24px 96px rgba(122,162,255,.08),0 14px 60px rgba(255,45,45,.06)}
    }
    .nav-sheet{position:fixed;inset:0 0 auto 0;background:rgba(0,0,0,.6);backdrop-filter:blur(8px);display:none}
    .nav-panel{position:absolute;top:0;right:0;width:82vw;max-width:380px;height:100%;background:rgba(14,16,22,.96);
      border-left:1px solid rgba(255,255,255,.08);padding:1rem}
    .nav-open .nav-sheet{display:block}
    .touch-target{min-height:44px;min-width:44px}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
  </style>

  <!-- Icons sprite -->
  <svg xmlns="http://www.w3.org/2000/svg" style="display:none">
    <symbol id="i-li" viewBox="0 0 24 24"><path fill="currentColor" d="M4.98 3.5C4.98 4.88 3.86 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1s2.48 1.12 2.48 2.5zM.5 8h4V23h-4zM8 8h3.8v2.05h.05c.53-1.01 1.84-2.08 3.79-2.08C20.42 8 21 11.05 21 14.77V23h-4v-7.03c0-1.68-.03-3.85-2.35-3.85-2.35 0-2.71 1.83-2.71 3.72V23H8z"/></symbol>
    <symbol id="i-x" viewBox="0 0 24 24"><path fill="currentColor" d="M18.9 2H22l-8 9.13L23.3 22H16l-6-7.05L3 22H0l8.6-9.83L-0.2 2H6.9l5 6.1z"/></symbol>
    <symbol id="i-mail" viewBox="0 0 24 24"><path fill="currentColor" d="M2 4h20v16H2z"/><path fill="#fff" d="M2 6l10 7L22 6"/></symbol>
    <symbol id="i-ig" viewBox="0 0 24 24"><path fill="currentColor" d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm5 5a5 5 0 1 0 .001 10.001A5 5 0 0 0 12 7zm6-1a1 1 0 1 0 .001 2.001A1 1 0 0 0 18 6z"/></symbol>
    <symbol id="i-tt" viewBox="0 0 24 24"><path fill="currentColor" d="M16 2c1 2.5 2.7 4.1 5 4.3v4.1c-1.9-.1-3.6-.6-5-1.5v7.3c0 4-3.3 6.7-6.7 6.7C6 23 3 20 3 16.7 3 13.3 5.7 10 9.7 10c.5 0 1 .1 1.5.2V14c-.5-.1-1-.2-1.5-.2-2 0-3.7 1.6-3.7 3.7 0 2 1.6 3.7 3.7 3.7 2 0 3.7-1.6 3.7-3.7V2z"/></symbol>
    <symbol id="i-reddit" viewBox="0 0 24 24"><path fill="currentColor" d="M20 12.5c.6.5 1 1.2 1 2 0 2.8-4 5-9 5s-9-2.2-9-5c0-.8.4-1.5 1-2 .2-2.3 2.3-4 5.1-4.6l1-4.5 3.4.7-.6 2.7c2.9.1 5.2 1.8 5.1 3.7z"/></symbol>
    <symbol id="i-fb" viewBox="0 0 24 24"><path fill="currentColor" d="M13 22V12h3l1-4h-4V6.5C13 5.7 13.3 5 14.6 5H17V1h-3c-3 0-5 1.8-5 5v2H6v4h3v10z"/></symbol>
    <symbol id="i-quora" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2c5.3 0 8.6 3.7 8.6 8.8 0 3.7-1.7 6.6-4.6 7.9l2.5 3.3-3.5 0-1.8-2.5c-.4.1-.8.1-1.2.1C7 19.6 3.4 16.2 3.4 10.8 3.4 5.7 6.7 2 12 2zm0 3.6c-3 0-4.9 2.3-4.9 5.2 0 3.3 1.9 5.2 4.9 5.2.5 0 .9 0 1.3-.2l-1.3-1.8 3.4 0 .6.8c1.5-1 2.3-2.7 2.3-4.9 0-2.9-1.9-5.2-4.9-5.2z"/></symbol>
    <symbol id="i-schedule" viewBox="0 0 24 24"><path fill="currentColor" d="M7 2h2v3H7V2m8 0h2v3h-2V2M3 7h18v14H3V7m8 2v5h5v-2h-3V9h-2z"/></symbol>
    <symbol id="i-analytics" viewBox="0 0 24 24"><path fill="currentColor" d="M3 3h2v18H3V3m4 8h2v10H7V11m4-6h2v16h-2V5m4 10h2v6h-2v-6m4-12h2v18h-2V3z"/></symbol>
  </svg>

  <!-- JSON-LD: Organization / Website / SoftwareApplication -->
  <script type="application/ld+json">{
    "@context":"https://schema.org",
    "@type":"Organization",
    "name":"ContentRepurpose.pro",
    "url":"https://contentrepurpose.pro/",
    "logo":"https://contentrepurpose.pro/logo.svg",
    "sameAs":["https://x.com/contentrepurpose","https://www.linkedin.com/company/contentrepurpose"]
  }</script>
  <script type="application/ld+json">{
    "@context":"https://schema.org",
    "@type":"WebSite",
    "url":"https://contentrepurpose.pro/",
    "name":"ContentRepurpose.pro",
    "potentialAction":{
      "@type":"SearchAction",
      "target":"https://contentrepurpose.pro/search?q={q}",
      "query-input":"required name=q"
    }
  }</script>
  <script type="application/ld+json">{
    "@context":"https://schema.org",
    "@type":"SoftwareApplication",
    "name":"ContentRepurpose.pro",
    "applicationCategory":"ContentCreationApplication",
    "operatingSystem":"Web",
    "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},
    "featureList":[
      "AI Content Repurposing",
      "LinkedIn, X, Instagram, TikTok, Reddit, Facebook, Quora, Email",
      "Per-platform Optimize actions",
      "Article Optimizer (headings, FAQs, SEO)",
      "Scheduler (Starter+)",
      "Analytics (Starter+)",
      "BYOK via OpenRouter and providers"
    ]
  }</script>
</head>

<body class="min-h-full" data-auth="guest">
  <!-- background halos -->
  <div class="halo" style="left:-14rem; top:-10rem;"></div>
  <div class="halo h2"></div>
  <div class="halo h3"></div>

  <!-- HEADER / NAV -->
  <header class="sticky top-0 z-40 backdrop-blur bg-white/55 dark:bg-black/20 border-b border-white/30">
    <div class="max-w-7xl mx-auto px-4 md:px-5 py-4 flex items-center justify-between">
      <a href="/" class="flex items-center gap-3" aria-label="ContentRepurpose home">
        <svg width="36" height="36" viewBox="0 0 48 48" class="rounded-xl" aria-hidden="true">
          <defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#7AA2FF"/><stop offset="100%" stop-color="#FF2D2D"/></linearGradient></defs>
          <rect x="0" y="0" width="48" height="48" rx="12" fill="url(#g)"/>
          <path d="M14 16h10a6 6 0 0 1 0 12H20v4h-6V16zm6 6v4h4a2 2 0 1 0 0-4h-4z" fill="white"/>
          <path d="M28 16h6v16h-6z" fill="white" opacity=".9"/>
        </svg>
        <span class="font-semibold tracking-tight">Content<span class="txt-grad">Repurpose</span></span>
      </a>

      <!-- Desktop nav -->
      <nav class="hidden md:flex items-center gap-6 text-sm">
        <a href="#demo" class="hover:opacity-80 guest-only">Live Demo</a>
        <a href="#how-it-works" class="hover:opacity-80 guest-only">How it works</a>
        <a href="#templates" class="hover:opacity-80 guest-only">Templates</a>
        <a href="#use-cases" class="hover:opacity-80 guest-only">Use cases</a>
        <a href="#pricing" class="hover:opacity-80">Pricing</a>

        <a href="#analytics" class="hover:opacity-80 member-only inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-analytics"/></svg> Analytics</a>
        <a href="#scheduler" class="hover:opacity-80 member-only inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-schedule"/></svg> Scheduler</a>

        <span id="planbadge" class="px-3 py-1 rounded-full text-xs bg-white/70 dark:bg-white/10 border border-white/50">Plan: Free</span>
        <button id="manageBilling" class="px-3 py-1 rounded-lg border hidden">Manage billing</button>

        <div class="flex items-center gap-2">
          <button id="loginBtn" class="px-3 py-1 rounded-lg border">Sign in</button>
          <button id="logoutBtn" class="px-3 py-1 rounded-lg border hidden">Sign out</button>
        </div>
      </nav>

      <!-- Mobile burger -->
      <button id="navToggle" class="md:hidden touch-target px-3 py-2 rounded-lg border" aria-expanded="false" aria-controls="mobileNav" aria-label="Open menu">
        <svg class="w-5 h-5" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2"/></svg>
      </button>
    </div>

    <!-- Mobile sheet -->
    <div id="mobileNav" class="nav-sheet" aria-hidden="true">
      <div class="nav-panel text-sm text-white">
        <div class="flex items-center justify-between">
          <span class="font-semibold">Menu</span>
          <button id="navClose" class="touch-target px-3 py-2 rounded-lg border border-white/20" aria-label="Close menu">
            <svg class="w-5 h-5" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M19 6.4 17.6 5 12 10.6 6.4 5 5 6.4 10.6 12 5 17.6 6.4 19 12 13.4 17.6 19 19 17.6 13.4 12z"/></svg>
          </button>
        </div>
        <nav class="mt-4 grid gap-2">
          <a href="#demo" class="px-3 py-2 rounded-lg hover:bg-white/10 guest-only">Live Demo</a>
          <a href="#how-it-works" class="px-3 py-2 rounded-lg hover:bg-white/10 guest-only">How it works</a>
          <a href="#templates" class="px-3 py-2 rounded-lg hover:bg-white/10 guest-only">Templates</a>
          <a href="#use-cases" class="px-3 py-2 rounded-lg hover:bg-white/10 guest-only">Use cases</a>
          <a href="#pricing" class="px-3 py-2 rounded-lg hover:bg-white/10">Pricing</a>
          <a href="#analytics" class="px-3 py-2 rounded-lg hover:bg-white/10 member-only inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-analytics"/></svg> Analytics</a>
          <a href="#scheduler" class="px-3 py-2 rounded-lg hover:bg-white/10 member-only inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-schedule"/></svg> Scheduler</a>
        </nav>
        <div class="mt-6 grid gap-2">
          <span id="planbadge_m" class="px-3 py-1 rounded-full text-xs bg-white/10 border border-white/20 w-fit">Plan: Free</span>
          <button id="manageBilling_m" class="px-3 py-2 rounded-lg border border-white/20 hidden">Manage billing</button>
          <button id="loginBtn_m" class="px-3 py-2 rounded-lg border border-white/20">Sign in</button>
          <button id="logoutBtn_m" class="px-3 py-2 rounded-lg border border-white/20 hidden">Sign out</button>
        </div>
      </div>
    </div>
  </header>

  <!-- HERO (marketing) -->
  <section class="relative guest-only">
    <div class="max-w-7xl mx-auto px-4 md:px-5 pt-10 md:pt-16 grid lg:grid-cols-2 gap-8 md:gap-10 items-center">
      <div>
        <div id="heroBadgeWrap" class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs bg-white/70 dark:bg-white/10 border border-white/40">
          <span class="w-2 h-2 rounded-full bg-emerald-500"></span>
          <span id="heroBadge">Demo — <strong class="mx-1">5 runs / month</strong> (no login)</span>
        </div>

        <h1 class="mt-4 text-3xl md:text-5xl font-black leading-tight tracking-tight">
          Paste once. <span class="txt-grad">Publish everywhere.</span>
        </h1>
        <p class="mt-4 text-slate-600 dark:text-slate-300 max-w-xl">
          Turn any <strong>URL, blog, or idea</strong> into channel-ready drafts for
          <strong>LinkedIn</strong>, <strong>X</strong>, <strong>Instagram</strong>, <strong>TikTok</strong>,
          <strong>Reddit</strong>, <strong>Facebook</strong>, <strong>Quora</strong>, and <strong>Email</strong> —
          plus a one-click <strong>LinkedIn Article</strong>. Optimize per platform, schedule, and track performance.
        </p>

        <div class="mt-6 flex flex-wrap gap-3">
          <a href="#demo" class="px-4 py-3 rounded-xl font-semibold text-white bg-black hover:opacity-90">Try the Live Demo</a>
          <a href="#pricing" class="px-4 py-3 rounded-xl font-semibold border border-slate-300/60 hover:bg-white/50">See pricing</a>
          <button id="heroSignIn" class="px-4 py-3 rounded-xl font-semibold border border-slate-300/60">Sign in</button>
        </div>

        <!-- Platform strip -->
        <div class="mt-7 grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3 max-w-lg">
          <span class="chip inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-li"/></svg> LinkedIn</span>
          <span class="chip inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-x"/></svg> X</span>
          <span class="chip inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-mail"/></svg> Email</span>
          <span class="chip inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-ig"/></svg> Instagram</span>
          <span class="chip inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-tt"/></svg> TikTok</span>
          <span class="chip inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-reddit"/></svg> Reddit</span>
          <span class="chip inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-fb"/></svg> Facebook</span>
          <span class="chip inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-quora"/></svg> Quora</span>
          <span class="chip inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-li"/></svg> LI Article</span>
        </div>

        <!-- Trust strip -->
        <div class="mt-6 flex items-center gap-3 text-xs text-slate-500 dark:text-slate-400">
          <span class="chip">Article Optimizer</span>
          <span class="chip">Per-platform Optimize</span>
          <span class="chip">Scheduler (Starter+)</span>
          <span class="chip">Analytics (Starter+)</span>
          <span class="chip">BYOK supported</span>
        </div>
      </div>

      <!-- Visual mock side -->
      <div class="relative">
        <div class="orbit" aria-hidden="true"></div>
        <div class="grid gap-4">
          <div class="mock p-4 card">
            <div class="text-xs text-slate-400">Command</div>
            <pre class="mono text-xs bg-black/85 text-emerald-200 rounded-xl p-4 h-40 overflow-auto" aria-label="CLI Preview">repurpose generate --channels linkedin,x,email,instagram,tiktok,reddit,facebook,quora
? outline created
? 2 X hooks + thread
? LI post + Article draft
? IG caption + hashtags
? TikTok script + on-screen text
? Reddit title + subreddit picks
? Email subject + body ready</pre>
          </div>
          <div class="grid md:grid-cols-2 gap-4">
            <div class="mock p-4 card">
              <div class="text-xs text-slate-400">LinkedIn</div>
              <div class="mt-2 h-24 text-sm text-slate-200/90 leading-relaxed">
                • Hook → value → CTA<br>
                • 6–10 lines, keywords kept<br>
                • One-click: LinkedIn Article
              </div>
            </div>
            <div class="mock p-4 card">
              <div class="text-xs text-slate-400">X (Twitter)</div>
              <div class="mt-2 h-24 text-sm text-slate-200/90 leading-relaxed">
                2 fast variants (≤ 280)<br>
                Thread expander on click<br>
                Hook bank A/B/C/D
              </div>
            </div>
          </div>
          <div class="grid md:grid-cols-2 gap-4">
            <div class="mock p-4 card">
              <div class="text-xs text-slate-400">Reddit</div>
              <div class="mt-2 h-24 text-sm text-slate-200/90 leading-relaxed">
                Title ideas + longform<br>
                Suggested subreddits<br>
                Credible sources prompt
              </div>
            </div>
            <div class="mock p-4 card">
              <div class="text-xs text-slate-400">TikTok</div>
              <div class="mt-2 h-24 text-sm text-slate-200/90 leading-relaxed">
                30–45s script beats<br>
                On-screen text plan<br>
                Hashtag sets
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Live activity strip (JS wires later) -->
    <div class="mt-8 md:mt-10">
      <div class="max-w-7xl mx-auto px-4 md:px-5">
        <div class="card p-4 md:p-5">
          <div class="flex items-center justify-between flex-wrap gap-3">
            <div class="flex items-center gap-2">
              <span class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
              <strong class="tracking-tight">Generations today</strong>
              <span id="liveCount" class="chip">–</span>
            </div>
            <div class="text-xs text-slate-500">Real results update every 30s</div>
          </div>
          <div class="mt-3 overflow-hidden">
            <div id="liveFeed" class="flex gap-3 whitespace-nowrap text-[13px] will-change-transform"></div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- DEMO / GENERATOR -->
  <section id="demo" class="relative guest-only scroll-mt-24">
    <div class="max-w-7xl mx-auto px-4 md:px-5 py-10 md:py-14">
      <div class="grid lg:grid-cols-12 gap-6 md:gap-8 items-start">
        <!-- LEFT: Inputs -->
        <div class="lg:col-span-5">
          <div class="card p-4 md:p-5">
            <div class="flex items-start justify-between">
              <div>
                <h2 class="text-xl md:text-2xl font-bold tracking-tight">Live Demo — No login</h2>
                <p class="mt-1 text-sm text-slate-500 dark:text-slate-400">Monthly demo limit: <strong id="demoLimit">5</strong>. Upsell appears after your 2nd run.</p>
              </div>
              <span class="chip" title="Remaining demo runs this month">
                <span id="demoRemaining">5</span> left
              </span>
            </div>

            <!-- Input: URL or Text -->
            <div class="mt-5 grid gap-3">
              <label for="inputMode" class="text-sm font-medium">Source</label>
              <div class="grid grid-cols-2 gap-2">
                <button id="modeURL" class="btn btn-primary" aria-pressed="true">URL</button>
                <button id="modeTEXT" class="btn" aria-pressed="false">Paste Text</button>
              </div>

              <div id="wrapURL" class="mt-3">
                <label for="sourceUrl" class="sr-only">Source URL</label>
                <input id="sourceUrl" class="w-full p-3 rounded-xl border" placeholder="https://example.com/blog-post" inputmode="url" autocomplete="off" />
                <div class="mt-2 text-xs text-slate-500">We’ll fetch the page, clean boilerplate, and keep your key headings & keywords.</div>
              </div>

              <div id="wrapTEXT" class="mt-3 hidden">
                <label for="sourceText" class="sr-only">Source Text</label>
                <textarea id="sourceText" class="w-full p-3 rounded-xl border min-h-[160px]" placeholder="Paste your article, notes, transcript, or brief…"></textarea>
                <div class="mt-2 text-xs text-slate-500">Large inputs are fine — we auto-summarize and preserve topical coverage.</div>
              </div>
            </div>

            <!-- Intent & Keywords -->
            <div class="mt-5 grid gap-3">
              <label class="text-sm font-medium">Intent & Guidance (optional)</label>
              <input id="primaryKeywords" class="w-full p-3 rounded-xl border" placeholder="Primary keywords (comma separated)" />
              <div class="grid grid-cols-2 gap-2">
                <select id="tone" class="p-3 rounded-xl border">
                  <option value="helpful">Tone: Helpful</option>
                  <option value="authoritative">Tone: Authoritative</option>
                  <option value="friendly">Tone: Friendly</option>
                  <option value="technical">Tone: Technical</option>
                  <option value="persuasive">Tone: Persuasive</option>
                  <option value="witty">Tone: Witty</option>
                </select>
                <select id="audience" class="p-3 rounded-xl border">
                  <option value="general">Audience: General</option>
                  <option value="marketers">Audience: Marketers</option>
                  <option value="founders">Audience: Founders</option>
                  <option value="engineers">Audience: Engineers</option>
                  <option value="creators">Audience: Creators</option>
                </select>
              </div>
            </div>

            <!-- Platforms -->
            <div class="mt-6">
              <label class="text-sm font-medium">Choose platforms</label>
              <div id="platformGrid" class="mt-3 grid grid-cols-2 sm:grid-cols-3 gap-2">
                <button data-pl="linkedin" class="btn platform active inline-flex items-center justify-between"><span class="inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-li"/></svg> LinkedIn</span><span class="chip">Post</span></button>
                <button data-pl="li-article" class="btn platform inline-flex items-center justify-between"><span class="inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-li"/></svg> LI Article</span><span class="chip">One-click</span></button>
                <button data-pl="x" class="btn platform active inline-flex items-center justify-between"><span class="inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-x"/></svg> X</span><span class="chip">2 Variants</span></button>
                <button data-pl="instagram" class="btn platform inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-ig"/></svg>Instagram</button>
                <button data-pl="tiktok" class="btn platform inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-tt"/></svg>TikTok</button>
                <button data-pl="reddit" class="btn platform inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-reddit"/></svg>Reddit</button>
                <button data-pl="facebook" class="btn platform inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-fb"/></svg>Facebook</button>
                <button data-pl="quora" class="btn platform inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-quora"/></svg>Quora</button>
                <button data-pl="email" class="btn platform active inline-flex items-center gap-2"><svg class="w-4 h-4"><use href="#i-mail"/></svg>Email</button>
              </div>
              <div class="mt-2 text-xs text-slate-500">Tip: You can toggle platforms anytime; Optimize actions are per-platform.</div>
            </div>

            <!-- Actions -->
            <div class="mt-6 flex flex-wrap items-center gap-3">
              <button id="runDemo" class="px-4 py-3 rounded-xl font-semibold text-white bg-black hover:opacity-90">Generate</button>
              <button id="clearAll" class="px-4 py-3 rounded-xl font-semibold border">Clear</button>
              <span id="demoStatus" class="text-sm text-slate-500"></span>
            </div>

            <!-- Upsell ribbon (appears after 2 demo runs) -->
            <div id="upsellAfterTwo" class="mt-5 hidden">
              <div class="p-4 rounded-xl border bg-white/70 dark:bg-white/10">
                <div class="flex items-center justify-between gap-4">
                  <div class="text-sm">
                    <strong>Love the results?</strong> Create a free account for <strong>5 daily</strong> generations,
                    Scheduler & Analytics on paid plans, Notion/Trello/Buffer exports, and more.
                  </div>
                  <button id="upsellSignIn" class="px-3 py-2 rounded-lg border">Sign in</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Integrations (disabled in guest) -->
          <div class="mt-4 card p-4 md:p-5">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold">Exports & Integrations</h3>
              <span class="chip">Starter+ unlocks</span>
            </div>
            <div class="mt-3 grid grid-cols-2 gap-2">
              <button class="px-3 py-2 rounded-lg border opacity-50 cursor-not-allowed" title="Sign in to connect Notion">Export to Notion</button>
              <button class="px-3 py-2 rounded-lg border opacity-50 cursor-not-allowed" title="Sign in to connect Trello">Export to Trello</button>
              <button class="px-3 py-2 rounded-lg border opacity-50 cursor-not-allowed" title="Sign in to connect Buffer">Send to Buffer</button>
              <button class="px-3 py-2 rounded-lg border opacity-50 cursor-not-allowed" title="Sign in to download CSVs">Download CSV</button>
            </div>
            <p class="mt-3 text-xs text-slate-500">Connect in one click after you sign in. We’ll guide you through Notion, Trello, and Buffer OAuth.</p>
          </div>
        </div>

        <!-- RIGHT: Outputs & Optimizer -->
        <div class="lg:col-span-7">
          <!-- Optimizer panel -->
          <div class="card p-4 md:p-5">
            <div class="flex items-center justify-between">
              <h3 class="font-semibold">Per-platform Optimize</h3>
              <div class="text-xs text-slate-500">Select a platform tab, then optimize.</div>
            </div>

            <div class="mt-4 grid md:grid-cols-4 gap-2">
              <button data-opt="shorten" class="btn w-full">Shorten</button>
              <button data-opt="expand" class="btn w-full">Expand</button>
              <button data-opt="hashtags" class="btn w-full">Hashtags</button>
              <button data-opt="cta" class="btn w-full">Add CTA</button>
            </div>

            <div class="mt-2 grid md:grid-cols-4 gap-2">
              <button data-opt="tone-friendlier" class="btn w-full">Friendlier</button>
              <button data-opt="tone-authoritative" class="btn w-full">More Authoritative</button>
              <button data-opt="readability" class="btn w-full">Improve Readability</button>
              <button data-opt="keywords" class="btn w-full">Reinforce Keywords</button>
            </div>
          </div>

          <!-- Tabs -->
          <div class="mt-4 card p-0 overflow-hidden">
            <div class="border-b flex flex-wrap">
              <button class="tab px-4 py-3 text-sm font-medium border-r active" data-tab="linkedin">LinkedIn</button>
              <button class="tab px-4 py-3 text-sm font-medium border-r" data-tab="li-article">LI Article</button>
              <button class="tab px-4 py-3 text-sm font-medium border-r" data-tab="x">X</button>
              <button class="tab px-4 py-3 text-sm font-medium border-r" data-tab="instagram">Instagram</button>
              <button class="tab px-4 py-3 text-sm font-medium border-r" data-tab="tiktok">TikTok</button>
              <button class="tab px-4 py-3 text-sm font-medium border-r" data-tab="reddit">Reddit</button>
              <button class="tab px-4 py-3 text-sm font-medium border-r" data-tab="facebook">Facebook</button>
              <button class="tab px-4 py-3 text-sm font-medium border-r" data-tab="quora">Quora</button>
              <button class="tab px-4 py-3 text-sm font-medium" data-tab="email">Email</button>
            </div>

            <!-- Panels -->
            <div id="panels" class="p-4 md:p-5">
              <!-- LinkedIn -->
              <div data-panel="linkedin">
                <div class="flex items-center justify-between gap-3">
                  <h4 class="font-semibold">LinkedIn Post</h4>
                  <div class="flex items-center gap-2">
                    <button data-copy="linkedin" class="btn">Copy</button>
                    <button data-save="linkedin" class="btn member-only">Save</button>
                  </div>
                </div>
                <textarea id="out-linkedin" class="mt-3 w-full p-3 rounded-xl border min-h-[180px]" placeholder="Your LinkedIn post will appear here…"></textarea>
              </div>

              <!-- LI Article -->
              <div data-panel="li-article" class="hidden">
                <div class="flex items-center justify-between gap-3">
                  <h4 class="font-semibold">LinkedIn Article</h4>
                  <div class="flex items-center gap-2">
                    <button data-copy="li-article" class="btn">Copy</button>
                    <button data-save="li-article" class="btn member-only">Save</button>
                  </div>
                </div>
                <textarea id="out-li-article" class="mt-3 w-full p-3 rounded-xl border min-h-[220px]" placeholder="Your LinkedIn Article draft…"></textarea>
              </div>

              <!-- X -->
              <div data-panel="x" class="hidden">
                <div class="flex items-center justify-between gap-3">
                  <h4 class="font-semibold">X (Twitter)</h4>
                  <div class="flex items-center gap-2">
                    <button data-copy="x" class="btn">Copy</button>
                    <button data-save="x" class="btn member-only">Save</button>
                  </div>
                </div>
                <textarea id="out-x" class="mt-3 w-full p-3 rounded-xl border min-h-[180px]" placeholder="Two concise variants, auto-generated…"></textarea>
              </div>

              <!-- Instagram -->
              <div data-panel="instagram" class="hidden">
                <div class="flex items-center justify-between gap-3">
                  <h4 class="font-semibold">Instagram</h4>
                  <div class="flex items-center gap-2">
                    <button data-copy="instagram" class="btn">Copy</button>
                    <button data-save="instagram" class="btn member-only">Save</button>
                  </div>
                </div>
                <textarea id="out-instagram" class="mt-3 w-full p-3 rounded-xl border min-h-[180px]" placeholder="Caption + suggested hashtags…"></textarea>
              </div>

              <!-- TikTok -->
              <div data-panel="tiktok" class="hidden">
                <div class="flex items-center justify-between gap-3">
                  <h4 class="font-semibold">TikTok Script</h4>
                  <div class="flex items-center gap-2">
                    <button data-copy="tiktok" class="btn">Copy</button>
                    <button data-save="tiktok" class="btn member-only">Save</button>
                  </div>
                </div>
                <textarea id="out-tiktok" class="mt-3 w-full p-3 rounded-xl border min-h-[180px]" placeholder="30–45s script beats + on-screen text…"></textarea>
              </div>

              <!-- Reddit -->
              <div data-panel="reddit" class="hidden">
                <div class="flex items-center justify-between gap-3">
                  <h4 class="font-semibold">Reddit</h4>
                  <div class="flex items-center gap-2">
                    <button data-copy="reddit" class="btn">Copy</button>
                    <button data-save="reddit" class="btn member-only">Save</button>
                  </div>
                </div>
                <textarea id="out-reddit" class="mt-3 w-full p-3 rounded-xl border min-h-[180px]" placeholder="Title ideas + longform body + suggested subreddits…"></textarea>
              </div>

              <!-- Facebook -->
              <div data-panel="facebook" class="hidden">
                <div class="flex items-center justify-between gap-3">
                  <h4 class="font-semibold">Facebook</h4>
                  <div class="flex items-center gap-2">
                    <button data-copy="facebook" class="btn">Copy</button>
                    <button data-save="facebook" class="btn member-only">Save</button>
                  </div>
                </div>
                <textarea id="out-facebook" class="mt-3 w-full p-3 rounded-xl border min-h-[180px]" placeholder="Page/Group friendly summary…"></textarea>
              </div>

              <!-- Quora -->
              <div data-panel="quora" class="hidden">
                <div class="flex items-center justify-between gap-3">
                  <h4 class="font-semibold">Quora Answer</h4>
                  <div class="flex items-center gap-2">
                    <button data-copy="quora" class="btn">Copy</button>
                    <button data-save="quora" class="btn member-only">Save</button>
                  </div>
                </div>
                <textarea id="out-quora" class="mt-3 w-full p-3 rounded-xl border min-h-[220px]" placeholder="Answer outline + supporting points…"></textarea>
              </div>

              <!-- Email -->
              <div data-panel="email" class="hidden">
                <div class="flex items-center justify-between gap-3">
                  <h4 class="font-semibold">Email</h4>
                  <div class="flex items-center gap-2">
                    <button data-copy="email" class="btn">Copy</button>
                    <button data-save="email" class="btn member-only">Save</button>
                  </div>
                </div>
                <textarea id="out-email" class="mt-3 w-full p-3 rounded-xl border min-h-[180px]" placeholder="Subject + body…"></textarea>
              </div>
            </div>
          </div>

          <!-- Helper: Keyword coverage & reading level -->
          <div class="mt-4 grid md:grid-cols-2 gap-4">
            <div class="card p-4 md:p-5">
              <h4 class="font-semibold">Keyword Coverage</h4>
              <p class="text-xs text-slate-500 mt-1">We’ll ensure your chosen keywords appear naturally in outputs.</p>
              <ul id="kwCoverage" class="mt-3 text-sm grid gap-2">
                <!-- JS will fill with badges: keyword + % presence -->
              </ul>
            </div>
            <div class="card p-4 md:p-5">
              <h4 class="font-semibold">Readability</h4>
              <p class="text-xs text-slate-500 mt-1">We aim for concise, skimmable, platform-fit content.</p>
              <div class="mt-3">
                <div class="flex items-center justify-between text-sm">
                  <span>Estimated Grade Level</span><strong id="readGrade">—</strong>
                </div>
                <div class="mt-2">
                  <div class="w-full h-2 rounded-full bg-white/30 overflow-hidden">
                    <div id="readScoreBar" class="h-2 bg-grad" style="width: 0%"></div>
                  </div>
                </div>
                <div id="readTips" class="mt-2 text-xs text-slate-500"></div>
              </div>
            </div>
          </div>

          <!-- Save row (guest disabled) -->
          <div class="mt-4 card p-4 md:p-5">
            <div class="flex items-center justify-between">
              <div class="text-sm">
                <strong>Want to save outputs?</strong> Sign in for a personal history, per-platform libraries, and exports.
              </div>
              <div class="flex items-center gap-2">
                <button class="px-3 py-2 rounded-lg border guest-only" id="signinFromOutputs">Sign in</button>
                <button class="px-3 py-2 rounded-lg border member-only hidden" id="saveAll">Save all</button>
              </div>
            </div>
          </div>

        </div> <!-- /RIGHT -->

      </div> <!-- /grid -->
    </div>
  </section>
  <!-- HOW IT WORKS -->
  <section id="how-it-works" class="scroll-mt-24">
    <div class="max-w-7xl mx-auto px-4 md:px-5 py-12 md:py-16">
      <h2 class="text-2xl md:text-3xl font-extrabold tracking-tight">How to repurpose content with ContentRepurpose</h2>
      <p class="mt-2 text-slate-600 dark:text-slate-300 max-w-3xl">
        Turn a <strong>URL, blog post, YouTube transcript, or paragraph</strong> into channel-perfect drafts. Our Article Optimizer preserves entities, headings, and search intent; Optimizer actions make each post native to its platform.
      </p>

      <div class="mt-6 grid md:grid-cols-3 gap-4">
        <div class="p-5 rounded-2xl border card">
          <div class="chip">Step 1</div>
          <h3 class="mt-2 font-semibold">Add a URL or paste text</h3>
          <p class="text-sm text-slate-500 mt-1">We fetch, clean, and structure the content. Optional: set tone, audience, and keywords.</p>
          <a href="#demo" class="mt-3 inline-block px-3 py-2 rounded-lg border text-sm">Open Demo</a>
        </div>
        <div class="p-5 rounded-2xl border card">
          <div class="chip">Step 2</div>
          <h3 class="mt-2 font-semibold">Pick platforms &amp; generate</h3>
          <p class="text-sm text-slate-500 mt-1">LinkedIn, X, Instagram, TikTok, Reddit, Facebook, Quora, Email — plus a one-click LinkedIn Article.</p>
          <span class="mt-3 inline-block text-xs text-slate-500">Free demo: 5 runs / month</span>
        </div>
        <div class="p-5 rounded-2xl border card">
          <div class="chip">Step 3</div>
          <h3 class="mt-2 font-semibold">Optimize, export, schedule</h3>
          <p class="text-sm text-slate-500 mt-1">Tweak with Optimizer actions, export to <strong>Notion/Trello/Buffer</strong>, or schedule posts (Starter+).</p>
          <a href="#pricing" class="mt-3 inline-block px-3 py-2 rounded-lg border text-sm">See Plans</a>
        </div>
      </div>
    </div>

    <!-- HowTo JSON-LD -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "How to repurpose an article into social posts with ContentRepurpose",
      "description": "Use ContentRepurpose to convert any URL or text into platform-perfect drafts for LinkedIn, X (Twitter), Instagram, TikTok, Reddit, Facebook, Quora, Email and a LinkedIn Article.",
      "totalTime": "PT2M",
      "tool": [{
        "@type": "SoftwareApplication",
        "name": "ContentRepurpose.pro",
        "applicationCategory": "ContentCreationApplication",
        "operatingSystem": "Web",
        "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" }
      }],
      "step": [
        { "@type": "HowToStep", "name": "Open the demo", "url": "#demo",
          "text": "Open the Live Demo and choose URL or Paste Text." },
        { "@type": "HowToStep", "name": "Add a URL or paste text",
          "text": "Paste a blog post, transcript, or a URL. Optionally set tone, audience, and keywords." },
        { "@type": "HowToStep", "name": "Pick platforms",
          "text": "Select LinkedIn, X, Instagram, TikTok, Reddit, Facebook, Quora, Email or LinkedIn Article." },
        { "@type": "HowToStep", "name": "Generate",
          "text": "Click Generate to create native, platform-optimized drafts." },
        { "@type": "HowToStep", "name": "Optimize and export",
          "text": "Use Optimizer actions (shorten, expand, hashtags, CTA, tone), then copy, export to Notion/Trello/Buffer, or schedule." }
      ]
    }
    </script>
  </section>

  <!-- TEMPLATES -->
  <section id="templates" class="scroll-mt-24">
    <div class="max-w-7xl mx-auto px-4 md:px-5 py-12 md:py-16">
      <h2 class="text-2xl md:text-3xl font-extrabold tracking-tight">Templates that ship results</h2>
      <p class="mt-2 text-slate-600 dark:text-slate-300 max-w-3xl">
        Pick a template, then personalize in seconds. Each template respects platform limits, reading patterns, and conversion best practices.
      </p>

      <div class="mt-6 grid md:grid-cols-2 lg:grid-cols-3 gap-4">
        <button class="p-5 rounded-2xl border card text-left template" data-template="li-hook" data-pl="linkedin">
          <div class="chip">LinkedIn</div>
          <h3 class="mt-2 font-semibold">Hook → Value → CTA</h3>
          <p class="text-sm text-slate-500 mt-1">10–14 lines, line breaks, minimal hashtags. One-click: LinkedIn Article.</p>
          <span class="mt-3 inline-block text-xs">Use with: thought leadership, launch, case study</span>
        </button>

        <button class="p-5 rounded-2xl border card text-left template" data-template="x-thread" data-pl="x">
          <div class="chip">X (Twitter)</div>
          <h3 class="mt-2 font-semibold">2 Variants + Thread Split</h3>
          <p class="text-sm text-slate-500 mt-1">≤280 chars per tweet. Auto thread beats and hook bank A/B/C/D.</p>
          <span class="mt-3 inline-block text-xs">Use with: listicles, frameworks, tips</span>
        </button>

        <button class="p-5 rounded-2xl border card text-left template" data-template="ig-caption" data-pl="instagram">
          <div class="chip">Instagram</div>
          <h3 class="mt-2 font-semibold">Caption + Hashtags</h3>
          <p class="text-sm text-slate-500 mt-1">Line breaks for skimming, CTA, 3x hashtag sets (S/M/L).</p>
          <span class="mt-3 inline-block text-xs">Use with: carousels, reels</span>
        </button>

        <button class="p-5 rounded-2xl border card text-left template" data-template="tt-script" data-pl="tiktok">
          <div class="chip">TikTok</div>
          <h3 class="mt-2 font-semibold">30–45s Script (Hook → Beats → CTA)</h3>
          <p class="text-sm text-slate-500 mt-1">On-screen text plan, caption ideas, and optional hashtags.</p>
          <span class="mt-3 inline-block text-xs">Use with: demos, mini-lessons</span>
        </button>

        <button class="p-5 rounded-2xl border card text-left template" data-template="reddit-longform" data-pl="reddit">
          <div class="chip">Reddit</div>
          <h3 class="mt-2 font-semibold">Title + Longform + Communities</h3>
          <p class="text-sm text-slate-500 mt-1">Attention-optimized titles and suggested subreddits.</p>
          <span class="mt-3 inline-block text-xs">Use with: lessons learned, playbooks</span>
        </button>

        <button class="p-5 rounded-2xl border card text-left template" data-template="quora-answer" data-pl="quora">
          <div class="chip">Quora</div>
          <h3 class="mt-2 font-semibold">Answer Outline → Draft</h3>
          <p class="text-sm text-slate-500 mt-1">Covers context, credibility, and an actionable conclusion.</p>
          <span class="mt-3 inline-block text-xs">Use with: expertise, how-tos</span>
        </button>

        <button class="p-5 rounded-2xl border card text-left template" data-template="email-longform" data-pl="email">
          <div class="chip">Email</div>
          <h3 class="mt-2 font-semibold">Subject A/B + Longform</h3>
          <p class="text-sm text-slate-500 mt-1">Story → value → CTA. Optional P.S. for secondary CTA.</p>
          <span class="mt-3 inline-block text-xs">Use with: newsletter, nurture</span>
        </button>

        <button class="p-5 rounded-2xl border card text-left template" data-template="li-article" data-pl="li-article">
          <div class="chip">LinkedIn Article</div>
          <h3 class="mt-2 font-semibold">Auto Headings + Summary + CTA</h3>
          <p class="text-sm text-slate-500 mt-1">SEO-aware outline, takeaways, and clean HTML export.</p>
          <span class="mt-3 inline-block text-xs">Use with: pillar content</span>
        </button>

        <button class="p-5 rounded-2xl border card text-left template" data-template="fb-page" data-pl="facebook">
          <div class="chip">Facebook</div>
          <h3 class="mt-2 font-semibold">Page Post / Group Discussion</h3>
          <p class="text-sm text-slate-500 mt-1">Headline, body, and share-friendly variation.</p>
          <span class="mt-3 inline-block text-xs">Use with: updates, community</span>
        </button>
      </div>

      <div class="mt-4">
        <a href="#demo" class="px-4 py-2 rounded-xl font-semibold border inline-block">Load a template in the Demo</a>
      </div>
    </div>
  </section>

  <!-- USE CASES (SEO) -->
  <section id="use-cases" class="scroll-mt-24">
    <div class="max-w-7xl mx-auto px-4 md:px-5 py-12 md:py-16">
      <h2 class="text-2xl md:text-3xl font-extrabold tracking-tight">Use cases & search-friendly solutions</h2>
      <p class="mt-2 text-slate-600 dark:text-slate-300 max-w-3xl">
        ContentRepurpose is the all-in-one <strong>AI content repurposing tool</strong> and <strong>social media post generator</strong> that keeps your voice consistent across channels.
      </p>

      <div class="mt-6 grid md:grid-cols-2 lg:grid-cols-3 gap-4">
        <div class="p-5 rounded-2xl border card">
          <h3 class="font-semibold">AI Content Repurposing</h3>
          <ul class="mt-2 text-sm list-disc pl-5 space-y-1">
            <li>Turn one article into 8+ platform-fit posts</li>
            <li>Preserve entities & topical coverage</li>
            <li>Automatic style & length adjustments</li>
          </ul>
        </div>

        <div class="p-5 rounded-2xl border card">
          <h3 class="font-semibold">LinkedIn Post Generator</h3>
          <ul class="mt-2 text-sm list-disc pl-5 space-y-1">
            <li>Hook → value → CTA structure</li>
            <li>Minimal, relevant hashtags</li>
            <li>One-click LinkedIn Article</li>
          </ul>
        </div>

        <div class="p-5 rounded-2xl border card">
          <h3 class="font-semibold">Twitter/X Thread Generator</h3>
          <ul class="mt-2 text-sm list-disc pl-5 space-y-1">
            <li>Thread beats and 2 fast variants</li>
            <li>Hook bank (A/B/C/D)</li>
            <li>Character-aware editing</li>
          </ul>
        </div>

        <div class="p-5 rounded-2xl border card">
          <h3 class="font-semibold">Instagram Caption Writer</h3>
          <ul class="mt-2 text-sm list-disc pl-5 space-y-1">
            <li>Skimmable captions with line breaks</li>
            <li>3 hashtag sets (S/M/L)</li>
            <li>Carousel outlines</li>
          </ul>
        </div>

        <div class="p-5 rounded-2xl border card">
          <h3 class="font-semibold">TikTok Script Generator</h3>
          <ul class="mt-2 text-sm list-disc pl-5 space-y-1">
            <li>30–45s script beats & on-screen text</li>
            <li>Captions + CTAs</li>
            <li>Posting timing tips</li>
          </ul>
        </div>

        <div class="p-5 rounded-2xl border card">
          <h3 class="font-semibold">Reddit Post Writer</h3>
          <ul class="mt-2 text-sm list-disc pl-5 space-y-1">
            <li>Attention-optimized titles and longform</li>
            <li>Suggested communities to target</li>
            <li>Credible tone & sources prompt</li>
          </ul>
        </div>

        <div class="p-5 rounded-2xl border card">
          <h3 class="font-semibold">Quora Answer Generator</h3>
          <ul class="mt-2 text-sm list-disc pl-5 space-y-1">
            <li>Clear outline → authoritative draft</li>
            <li>Examples & credibility cues</li>
            <li>CTA to profile or lead magnet</li>
          </ul>
        </div>

        <div class="p-5 rounded-2xl border card">
          <h3 class="font-semibold">Email Subject & Body Generator</h3>
          <ul class="mt-2 text-sm list-disc pl-5 space-y-1">
            <li>Subject line A/B + preheaders</li>
            <li>Story → value → CTA format</li>
            <li>Optional P.S. second CTA</li>
          </ul>
        </div>

        <div class="p-5 rounded-2xl border card">
          <h3 class="font-semibold">Article Optimizer & SEO</h3>
          <ul class="mt-2 text-sm list-disc pl-5 space-y-1">
            <li>Auto headings, FAQs, takeaways</li>
            <li>Humanize & lengthen passes</li>
            <li>Clean HTML export for CMS</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- BEST PICKS -->
  <section id="best-picks" class="scroll-mt-24">
    <div class="max-w-7xl mx-auto px-4 md:px-5 py-12 md:py-16">
      <h2 class="text-2xl md:text-3xl font-extrabold tracking-tight">Best picks today</h2>
      <p class="mt-2 text-slate-600 dark:text-slate-300 max-w-3xl">Popular combinations that creators love. Load one and hit Generate.</p>

      <div class="mt-6 grid md:grid-cols-3 gap-4">
        <button class="p-5 rounded-2xl border card text-left best-pick" data-pls="linkedin,x,email" data-template="li-hook">
          <h3 class="font-semibold">Thought-leadership launch</h3>
          <p class="text-sm text-slate-500 mt-1">LinkedIn + X + Email. Hook-led story with a clear CTA.</p>
          <span class="mt-3 inline-block text-xs">Goal: awareness → trial</span>
        </button>

        <button class="p-5 rounded-2xl border card text-left best-pick" data-pls="instagram,tiktok" data-template="tt-script">
          <h3 class="font-semibold">Product demo (short-form)</h3>
          <p class="text-sm text-slate-500 mt-1">Instagram + TikTok. Script beats and on-screen cues.</p>
          <span class="mt-3 inline-block text-xs">Goal: views → profile</span>
        </button>

        <button class="p-5 rounded-2xl border card text-left best-pick" data-pls="reddit,quora,li-article" data-template="li-article">
          <h3 class="font-semibold">Authority building</h3>
          <p class="text-sm text-slate-500 mt-1">Reddit + Quora + LI Article. Longform credibility + SERP capture.</p>
          <span class="mt-3 inline-block text-xs">Goal: backlinks → leads</span>
        </button>
      </div>

      <div class="mt-4">
        <a href="#demo" class="px-4 py-2 rounded-xl font-semibold border inline-block">Load a best pick in the Demo</a>
      </div>
    </div>
  </section>
  <!-- PRICING -->
  <section id="pricing" class="scroll-mt-24">
    <div class="max-w-7xl mx-auto px-4 md:px-5 py-14">
      <h2 class="text-2xl md:text-3xl font-extrabold tracking-tight">Simple pricing that grows with you</h2>
      <p class="text-slate-600 dark:text-slate-300 mt-2">Switch plans anytime. <strong>BYOK</strong> available on all plans.</p>

      <div class="mt-6 grid md:grid-cols-2 lg:grid-cols-4 gap-5">
        <!-- Free -->
        <div class="p-5 rounded-2xl border card">
          <div class="flex items-center justify-between">
            <strong>Free</strong><span class="chip">Get started</span>
          </div>
          <div class="text-3xl font-extrabold mt-2">$0</div>
          <ul class="mt-4 text-sm space-y-2">
            <li>5 daily platform generations</li>
            <li>BYOK: 5/day</li>
            <li>Article Optimizer: 1/day</li>
            <li>LinkedIn, X, Instagram, Email</li>
            <li class="opacity-60">TikTok, Reddit, Facebook, Quora</li>
            <li class="opacity-60">Scheduler &amp; Analytics</li>
          </ul>
          <button id="ctaSignup2" class="mt-5 w-full px-4 py-2 rounded-xl font-semibold border" type="button">
            Create free account
          </button>
        </div>

        <!-- Starter -->
        <div class="p-5 rounded-2xl border card">
          <div class="flex items-center justify-between">
            <strong>Starter</strong><span class="chip">Best for solo</span>
          </div>
          <div class="text-3xl font-extrabold mt-2">$19</div>
          <ul class="mt-4 text-sm space-y-2">
            <li>25 daily platform generations</li>
            <li>BYOK: 100/day</li>
            <li>Article Optimizer</li>
            <li>All platforms incl. TikTok, Reddit, Facebook, Quora</li>
            <li>Scheduler &amp; Analytics</li>
          </ul>
          <button id="checkout-starter" class="mt-5 w-full px-4 py-2 rounded-xl font-semibold text-white bg-black" type="button">
            Choose Starter
          </button>
        </div>

        <!-- Creator -->
        <div class="p-5 rounded-2xl border card">
          <div class="flex items-center justify-between">
            <strong>Creator</strong><span class="chip">For power posters</span>
          </div>
          <div class="text-3xl font-extrabold mt-2">$39</div>
          <ul class="mt-4 text-sm space-y-2">
            <li>50 daily platform generations</li>
            <li>BYOK: 300/day</li>
            <li>Article Optimizer + export</li>
            <li>All platforms + Optimizations</li>
            <li>Scheduler &amp; Analytics</li>
          </ul>
          <button id="checkout-creator" class="mt-5 w-full px-4 py-2 rounded-xl font-semibold text-white bg-black" type="button">
            Choose Creator
          </button>
        </div>

        <!-- Business -->
        <div class="p-5 rounded-2xl border card">
          <div class="flex items-center justify-between">
            <strong>Business</strong><span class="chip">Teams &amp; brands</span>
          </div>
          <div class="text-3xl font-extrabold mt-2">$99</div>
          <ul class="mt-4 text-sm space-y-2">
            <li>100 daily platform generations</li>
            <li>BYOK: Unlimited</li>
            <li>Article Optimizer + export</li>
            <li>Scheduler &amp; Analytics + Team seats</li>
            <li>Shared presets &amp; calendar</li>
          </ul>
          <button id="checkout-business" class="mt-5 w-full px-4 py-2 rounded-xl font-semibold text-white bg-black" type="button">
            Choose Business
          </button>
        </div>
      </div>

      <p class="text-xs text-slate-500 mt-3">Need higher limits or SSO? Contact sales.</p>

      <!-- Upsell strip (persistent CTA) -->
      <div class="mt-6 p-5 rounded-2xl border card flex items-center justify-between flex-wrap gap-3">
        <div class="flex items-center gap-3">
          <span class="chip">Upgrade tip</span>
          <span class="text-sm">Most users unlock <strong>Scheduler & Analytics</strong> with Starter in under 2 minutes.</span>
        </div>
        <div class="flex items-center gap-2">
          <button id="manageBilling" class="px-3 py-2 rounded-lg border hidden" type="button">Manage billing</button>
          <button id="checkout-starter-cta" class="px-4 py-2 rounded-lg bg-black text-white" type="button">Start Starter</button>
        </div>
      </div>
    </div>
  </section>

  <!-- TRUST / PROOF -->
  <section id="trust" class="scroll-mt-24">
    <div class="max-w-7xl mx-auto px-4 md:px-5 py-12">
      <div class="grid md:grid-cols-3 gap-4">
        <div class="p-5 rounded-2xl border card">
          <div class="text-xs text-slate-500">Generations today</div>
          <div class="text-3xl font-extrabold mt-1"><span id="proofCount">–</span></div>
          <p class="text-sm text-slate-500 mt-1">Real usage refreshes every 30 seconds.</p>
        </div>
        <div class="p-5 rounded-2xl border card">
          <div class="text-xs text-slate-500">Repurposing time saved</div>
          <div class="text-3xl font-extrabold mt-1">5× faster</div>
          <p class="text-sm text-slate-500 mt-1">Avg. from brief → platform-ready drafts.</p>
        </div>
        <div class="p-5 rounded-2xl border card">
          <div class="text-xs text-slate-500">Supported channels</div>
          <div class="text-3xl font-extrabold mt-1">9</div>
          <p class="text-sm text-slate-500 mt-1">LinkedIn, X, Instagram, TikTok, Reddit, Facebook, Quora, Email, LI Article.</p>
        </div>
      </div>

      <div class="mt-6 grid md:grid-cols-3 gap-4">
        <div class="p-5 rounded-2xl border">
          <strong>“Makes every platform feel native.”</strong>
          <p class="text-sm text-slate-500 mt-2">We turned one 900-word post into a LinkedIn article, Reddit longform, X thread, and IG caption in minutes.</p>
          <div class="mt-3 text-xs text-slate-400">— B2B Creator</div>
        </div>
        <div class="p-5 rounded-2xl border">
          <strong>“Finally using LinkedIn Articles.”</strong>
          <p class="text-sm text-slate-500 mt-2">Auto headings + takeaways + clean HTML export. Looks like we hand-crafted it.</p>
          <div class="mt-3 text-xs text-slate-400">— Content Lead</div>
        </div>
        <div class="p-5 rounded-2xl border">
          <strong>“Scheduler saves my mornings.”</strong>
          <p class="text-sm text-slate-500 mt-2">Preset bundles + weekly cadence = consistent posting without chaos.</p>
          <div class="mt-3 text-xs text-slate-400">— Solo Founder</div>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQS (Expanded) -->
  <section id="faqs" class="scroll-mt-24">
    <div class="max-w-5xl mx-auto px-4 md:px-5 py-12">
      <h2 class="text-2xl md:text-3xl font-extrabold tracking-tight">FAQs</h2>
      <div class="mt-5 space-y-3">
        <details class="p-4 rounded-xl border">
          <summary class="font-semibold">What’s new in this release?</summary>
          <p class="mt-2 text-sm text-slate-600 dark:text-slate-300">
            TikTok, Reddit, Facebook, and Quora support; Article Optimizer with humanize/lengthen/FAQs/SEO; platform-specific “Optimize”; Scheduler &amp; Analytics (Starter+); and a refined UI that feels instant.
          </p>
        </details>

        <details class="p-4 rounded-xl border">
          <summary class="font-semibold">How does the platform-specific “Optimize” work?</summary>
          <p class="mt-2 text-sm">
            Click <em>Optimize</em> on any channel card. Examples: Reddit suggests communities and adapts tone; LinkedIn turns a post into an Article; X adds hooks and thread splits; Quora proposes questions and answer outlines; TikTok generates a 30–45s script with on-screen text; Email adds subject A/Bs and preheaders.
          </p>
        </details>

        <details class="p-4 rounded-xl border">
          <summary class="font-semibold">What are the Free plan limits?</summary>
          <p class="mt-2 text-sm">
            Free includes <strong>5 daily platform generations</strong>, <strong>BYOK 5/day</strong>, and <strong>Article Optimizer 1/day</strong>. Starter+ unlocks all platforms, Scheduler, and Analytics.
          </p>
        </details>

        <details class="p-4 rounded-xl border">
          <summary class="font-semibold">How do I use the Article Optimizer?</summary>
          <p class="mt-2 text-sm">
            Go to <em>Article Optimizer</em>, paste your article or add a URL. Choose passes (Humanize, Lengthen, FAQs, SEO, Headings) and click <strong>Optimize</strong>. Copy or download clean HTML, export to Notion/Trello, or generate drafts for selected channels.
          </p>
        </details>

        <details class="p-4 rounded-xl border">
          <summary class="font-semibold">What’s BYOK and why use it?</summary>
          <p class="mt-2 text-sm">
            <strong>Bring Your Own Key</strong> lets you use your own LLM provider (OpenRouter, OpenAI, Anthropic, Together, Groq, or a custom OpenAI-compatible base). You control costs and models. We enforce fair daily limits by plan.
          </p>
        </details>

        <details class="p-4 rounded-xl border">
          <summary class="font-semibold">Can I publish directly?</summary>
          <p class="mt-2 text-sm">
            Yes—connect <strong>Buffer</strong> to queue posts or export to <strong>Notion</strong>/<strong>Trello</strong>. Additionally, you can open each platform’s native composer for final tweaks before posting.
          </p>
        </details>

        <details class="p-4 rounded-xl border">
          <summary class="font-semibold">How do quotas and the demo work?</summary>
          <p class="mt-2 text-sm">
            The anonymous Live Demo is capped at <strong>5 runs / month</strong> per IP. After your second demo, you’ll see a prompt to <strong>sign in</strong> for daily limits (5/day on Free) and member features. Paid plans increase daily platform and BYOK limits.
          </p>
        </details>

        <details class="p-4 rounded-xl border">
          <summary class="font-semibold">Do you support teams and white-label?</summary>
          <p class="mt-2 text-sm">
            <strong>Business</strong> includes team seats, shared presets, and white-label exports. Invite teammates and manage seats under the Team section.
          </p>
        </details>

        <details class="p-4 rounded-xl border">
          <summary class="font-semibold">Which keywords describe ContentRepurpose best?</summary>
          <p class="mt-2 text-sm">
            AI content repurposing tool, social media post generator, LinkedIn post generator, Twitter/X thread generator, Instagram caption writer, TikTok script generator, Reddit post writer, Quora answer generator, article optimizer, scheduler, analytics, BYOK.
          </p>
        </details>
      </div>
    </div>

    <!-- FAQPage JSON-LD -->
    <script type="application/ld+json">
    {
      "@context":"https://schema.org",
      "@type":"FAQPage",
      "mainEntity":[
        {"@type":"Question","name":"What’s new in this release?","acceptedAnswer":{"@type":"Answer","text":"TikTok, Reddit, Facebook, and Quora support; Article Optimizer; platform Optimizer actions; Scheduler & Analytics; and improved UI."}},
        {"@type":"Question","name":"How does the platform-specific Optimizer work?","acceptedAnswer":{"@type":"Answer","text":"Click Optimize on any channel card to add Reddit communities, LinkedIn Articles, X hooks/threads, Quora questions/answers, TikTok scripts, and Email subject A/Bs."}},
        {"@type":"Question","name":"What are the Free plan limits?","acceptedAnswer":{"@type":"Answer","text":"Free includes 5 daily platform generations, BYOK 5/day, and Article Optimizer 1/day. Starter+ unlocks all platforms, Scheduler, and Analytics."}},
        {"@type":"Question","name":"How do I use the Article Optimizer?","acceptedAnswer":{"@type":"Answer","text":"Paste your article or add a URL, choose passes (Humanize, Lengthen, FAQs, SEO, Headings), click Optimize, then copy/download HTML or export."}},
        {"@type":"Question","name":"What’s BYOK and why use it?","acceptedAnswer":{"@type":"Answer","text":"Bring Your Own Key allows using your own LLM provider via OpenRouter, OpenAI, Anthropic, Together, Groq, or custom OpenAI-compatible base."}},
        {"@type":"Question","name":"Can I publish directly?","acceptedAnswer":{"@type":"Answer","text":"Yes—queue via Buffer or export to Notion/Trello. You can also open native composers for each platform."}},
        {"@type":"Question","name":"How do quotas and the demo work?","acceptedAnswer":{"@type":"Answer","text":"Anonymous demo is 5 runs/month per IP. After two runs we prompt sign-in for 5/day on Free and member features. Paid plans raise limits."}},
        {"@type":"Question","name":"Do you support teams and white-label?","acceptedAnswer":{"@type":"Answer","text":"Business includes team seats, shared presets, and white-label exports."}}
      ]
    }
    </script>
  </section>

  <!-- DEMO → SIGN-IN UPSELL MODAL (appears after 2 demo runs) -->
  <div id="upsellModal" class="fixed inset-0 z-[100] hidden" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm"></div>
    <div class="relative mx-auto mt-24 w-[92vw] max-w-md">
      <div class="p-5 rounded-2xl border card bg-white/90 dark:bg-black/70">
        <div class="flex items-start justify-between">
          <h3 class="text-lg font-bold">Get 5/day + Scheduler &amp; Analytics</h3>
          <button id="upsellClose" class="px-2 py-1 rounded-lg border" aria-label="Close">✕</button>
        </div>
        <p class="mt-2 text-sm text-slate-600 dark:text-slate-300">
          You’ve tried the demo. Create your free account for <strong>5 daily</strong> runs, save BYOK, and unlock member features.
        </p>
        <ul class="mt-3 text-sm list-disc pl-5 space-y-1">
          <li>Platform-perfect drafts for 9 channels</li>
          <li>Article Optimizer with clean HTML export</li>
          <li>Starter+: Scheduler &amp; Analytics</li>
        </ul>
        <div class="mt-4 grid grid-cols-2 gap-2">
          <button id="upsellSignup" class="px-4 py-2 rounded-lg border" type="button">Create free account</button>
          <button id="upsellCheckoutStarter" class="px-4 py-2 rounded-lg bg-black text-white" type="button">Start Starter</button>
        </div>
      </div>
    </div>
  </div>
  <!-- ===== MEMBER VIEW (SIGNED IN) ===== -->
  <section id="memberView" class="hidden member-only scroll-mt-24">
    <div class="max-w-7xl mx-auto px-4 md:px-5 pb-12">
      <!-- Header -->
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mt-8 mb-6">
        <div>
          <h2 class="text-2xl md:text-3xl font-extrabold tracking-tight">Dashboard</h2>
          <p class="text-slate-600 dark:text-slate-300">Welcome back, <span id="userEmail" class="font-medium"></span></p>
        </div>
        <div class="flex items-center gap-3">
          <span id="memberPlanBadge" class="px-3 py-1 rounded-full text-xs bg-white/70 dark:bg-white/10 border border-white/50">Plan: Free</span>
          <button id="manageBilling2" class="px-3 py-1 rounded-lg border hidden" type="button">Manage billing</button>
          <button id="logoutBtn2" class="px-3 py-1 rounded-lg border" type="button">Sign out</button>
        </div>
      </div>

      <!-- Quota tiles -->
      <div id="quotaCards" class="grid sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-6"></div>

      <!-- Member Generator -->
      <div class="card p-6" id="memberGenerator">
        <div class="flex items-center justify-between gap-3 flex-wrap">
          <h3 class="text-xl font-bold tracking-tight">Create new content</h3>
          <div class="flex items-center gap-3 flex-wrap">
            <label class="text-xs flex items-center gap-2">
              <input id="whitelabel" type="checkbox" class="hidden">
              <span id="wlLabel" class="chip hidden">White-label export</span>
            </label>
            <button id="exportPack" class="btn hidden" type="button">Export Project Pack (.md)</button>
            <span id="quotaMember" class="px-3 py-1 rounded-full text-xs bg-white/70 dark:bg-white/10 border border-white/50">Today: 0/5</span>
          </div>
        </div>

        <!-- Channel selector -->
        <div class="mt-4">
          <div class="text-xs text-slate-500 mb-2">Select channels</div>
          <div id="channelSelector_m" class="flex flex-wrap gap-2">
            <button class="chip channel-pill" data-channel="linkedin" aria-pressed="true">LinkedIn</button>
            <button class="chip channel-pill" data-channel="x" aria-pressed="true">X</button>
            <button class="chip channel-pill" data-channel="email" aria-pressed="true">Email</button>
            <button class="chip channel-pill" data-channel="instagram" aria-pressed="true">Instagram</button>
            <button class="chip channel-pill" data-channel="tiktok" aria-pressed="false">TikTok</button>
            <button class="chip channel-pill" data-channel="reddit" aria-pressed="false">Reddit</button>
            <button class="chip channel-pill" data-channel="facebook" aria-pressed="false">Facebook</button>
            <button class="chip channel-pill" data-channel="quora" aria-pressed="false">Quora</button>
            <button class="chip channel-pill" data-channel="li_article" aria-pressed="false">LinkedIn Article</button>
          </div>
        </div>

        <textarea id="source_m" class="mt-4 w-full h-40 p-3 rounded-xl border border-slate-200/70 focus:outline-none focus:ring-2 focus:ring-slate-300 dark:bg-black/30" placeholder="Paste a paragraph, blog snippet, or outline…"></textarea>

        <!-- BYOK quick settings -->
        <details class="mt-4">
          <summary class="cursor-pointer text-sm text-slate-500">BYOK settings (optional)</summary>
          <div class="grid md:grid-cols-3 gap-3 mt-3">
            <input id="model_m" class="p-2 rounded-xl border border-slate-200/70 dark:bg-black/30" placeholder="Preferred model (optional)" />
            <select id="byok_provider_m" class="p-2 rounded-xl border border-slate-200/70 dark:bg-black/30">
              <option value="">Provider (auto)</option>
              <option value="openrouter">OpenRouter</option>
              <option value="openai">OpenAI</option>
              <option value="anthropic">Anthropic</option>
              <option value="together">Together</option>
              <option value="groq">Groq</option>
              <option value="custom">Custom (OpenAI-compatible)</option>
            </select>
            <input id="byok_key_m" class="p-2 rounded-xl border border-slate-200/70 dark:bg-black/30" placeholder="Your API key (BYOK)" />
            <input id="byok_base_m" class="p-2 rounded-xl border border-slate-200/70 dark:bg-black/30 md:col-span-2" placeholder="Custom base URL (if custom provider)" />
            <button id="save_m" class="px-4 py-2 rounded-xl font-semibold border border-slate-300/60 hover:bg-white/50" type="button">Save to my account</button>
          </div>
          <p class="text-xs text-slate-500 mt-2">Your BYOK is only used when you click “Generate with your BYOK”.</p>
        </details>

        <div class="mt-4 flex flex-wrap items-center gap-3">
          <button id="run_m" class="px-4 py-2 rounded-xl font-semibold text-white bg-black hover:opacity-90" type="button">Generate (Selected)</button>
          <button id="run-byok_m" class="px-4 py-2 rounded-xl font-semibold text-white bg-emerald-600 hover:opacity-90" type="button">Generate with your BYOK</button>
          <button id="clear_m" class="px-4 py-2 rounded-xl font-semibold border border-slate-300/60 hover:bg-white/50" type="button">Clear</button>
          <span id="status_m" class="text-sm text-slate-500" role="status" aria-live="polite"></span>
        </div>
      </div>

      <!-- Batch Inputs -->
      <div class="card p-6 mt-6" id="memberBatch">
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-bold">Batch inputs</h3>
          <small id="batchNote" class="text-slate-500"></small>
        </div>
        <p class="text-sm text-slate-500 mt-2">Add one idea or URL per line. Your plan controls how many lines per run.</p>
        <textarea id="batch_inputs" class="mt-3 w-full h-40 p-3 rounded-xl border border-slate-200/70 focus:outline-none focus:ring-2 focus:ring-slate-300 dark:bg-black/30" placeholder="Line 1: …&#10;Line 2: …&#10;Line 3: …" disabled></textarea>
        <div class="mt-3 flex items-center gap-3">
          <button id="run_batch" class="px-4 py-2 rounded-xl font-semibold text-white bg-black hover:opacity-90 hidden" type="button">Run batch</button>
          <span class="text-xs text-slate-500">Progress:</span>
        </div>
        <ul id="batch_progress" class="mt-3 text-sm space-y-1"></ul>
      </div>

      <!-- Outputs + Publish -->
      <div class="grid lg:grid-cols-2 gap-5 mt-6" id="memberOutputs">
        <!-- LinkedIn -->
        <div class="card p-5">
          <div class="flex justify-between items-center gap-2 flex-wrap">
            <strong class="tracking-tight inline-flex items-center gap-2">LinkedIn</strong>
            <div class="flex items-center gap-2">
              <button id="optimize-li_m" class="px-3 py-1 rounded-full text-xs border" type="button">Optimize</button>
              <button id="copy-li_m" class="px-3 py-1 rounded-full text-xs border" type="button">Copy</button>
              <button id="publish-li_m" class="px-3 py-1 rounded-full text-xs border" type="button">Publish</button>
              <button id="li-notion" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Export to Notion</button>
              <button id="li-trello" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Send to Trello</button>
              <button id="li-buffer" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Queue in Buffer</button>
            </div>
          </div>
          <pre id="out-li_m" class="whitespace-pre-wrap text-sm mt-3"></pre>
        </div>

        <!-- X -->
        <div class="card p-5">
          <div class="flex justify-between items-center gap-2 flex-wrap">
            <strong class="tracking-tight inline-flex items-center gap-2">X (Twitter)</strong>
            <div class="flex items-center gap-2">
              <button id="optimize-x_m" class="px-3 py-1 rounded-full text-xs border" type="button">Optimize</button>
              <button id="copy-x_m" class="px-3 py-1 rounded-full text-xs border" type="button">Copy</button>
              <button id="publish-x_m" class="px-3 py-1 rounded-full text-xs border" type="button">Publish</button>
              <button id="x-notion" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Export to Notion</button>
              <button id="x-trello" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Send to Trello</button>
              <button id="x-buffer" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Queue in Buffer</button>
            </div>
          </div>
          <pre id="out-x_m" class="whitespace-pre-wrap text-sm mt-3"></pre>
        </div>

        <!-- Email -->
        <div class="card p-5">
          <div class="flex justify-between items-center gap-2 flex-wrap">
            <strong class="tracking-tight inline-flex items-center gap-2">Email</strong>
            <div class="flex items-center gap-2">
              <button id="optimize-em_m" class="px-3 py-1 rounded-full text-xs border" type="button">Optimize</button>
              <button id="copy-em_m" class="px-3 py-1 rounded-full text-xs border" type="button">Copy</button>
              <button id="publish-em_m" class="px-3 py-1 rounded-full text-xs border" type="button">Preview &amp; Send</button>
              <button id="em-notion" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Export to Notion</button>
              <button id="em-trello" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Send to Trello</button>
              <button id="em-buffer" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Queue in Buffer</button>
            </div>
          </div>
          <div class="text-xs text-slate-400">Subject:</div>
          <pre id="out-em-subj_m" class="whitespace-pre-wrap text-sm mt-1"></pre>
          <div class="text-xs text-slate-400 mt-3">Body:</div>
          <pre id="out-em-body_m" class="whitespace-pre-wrap text-sm mt-1"></pre>
        </div>

        <!-- Instagram -->
        <div class="card p-5">
          <div class="flex justify-between items-center gap-2 flex-wrap">
            <strong class="tracking-tight inline-flex items-center gap-2">Instagram</strong>
            <div class="flex items-center gap-2">
              <button id="optimize-ig_m" class="px-3 py-1 rounded-full text-xs border" type="button">Optimize</button>
              <button id="copy-ig_m" class="px-3 py-1 rounded-full text-xs border" type="button">Copy</button>
              <button id="publish-ig_m" class="px-3 py-1 rounded-full text-xs border" type="button">Open Creator Studio</button>
              <button id="ig-notion" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Export to Notion</button>
              <button id="ig-trello" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Send to Trello</button>
              <button id="ig-buffer" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Queue in Buffer</button>
            </div>
          </div>
          <pre id="out-ig_m" class="whitespace-pre-wrap text-sm mt-3"></pre>
        </div>

        <!-- TikTok -->
        <div class="card p-5">
          <div class="flex justify-between items-center gap-2 flex-wrap">
            <strong class="tracking-tight inline-flex items-center gap-2">TikTok</strong>
            <div class="flex items-center gap-2">
              <button id="optimize-tt_m" class="px-3 py-1 rounded-full text-xs border" type="button">Optimize</button>
              <button id="copy-tt_m" class="px-3 py-1 rounded-full text-xs border" type="button">Copy</button>
              <button id="publish-tt_m" class="px-3 py-1 rounded-full text-xs border" type="button">Open Upload</button>
            </div>
          </div>
          <pre id="out-tt_m" class="whitespace-pre-wrap text-sm mt-3"></pre>
        </div>

        <!-- Reddit -->
        <div class="card p-5">
          <div class="flex justify-between items-center gap-2 flex-wrap">
            <strong class="tracking-tight inline-flex items-center gap-2">Reddit</strong>
            <div class="flex items-center gap-2">
              <button id="optimize-reddit_m" class="px-3 py-1 rounded-full text-xs border" type="button">Optimize</button>
              <button id="copy-reddit_m" class="px-3 py-1 rounded-full text-xs border" type="button">Copy</button>
              <button id="publish-reddit_m" class="px-3 py-1 rounded-full text-xs border" type="button">Open Submit</button>
            </div>
          </div>
          <div class="text-xs text-slate-400">Suggested communities</div>
          <div class="mt-1">
            <input id="redditSearch_m" class="w-full p-2 rounded-xl border border-slate-200/70 dark:bg-black/30" placeholder="Search communities (e.g., r/marketing)" />
            <ul id="redditSuggestions_m" class="mt-2 text-sm space-y-1"></ul>
          </div>
          <pre id="out-reddit_m" class="whitespace-pre-wrap text-sm mt-3"></pre>
        </div>

        <!-- Facebook -->
        <div class="card p-5">
          <div class="flex justify-between items-center gap-2 flex-wrap">
            <strong class="tracking-tight inline-flex items-center gap-2">Facebook</strong>
            <div class="flex items-center gap-2">
              <button id="optimize-fb_m" class="px-3 py-1 rounded-full text-xs border" type="button">Optimize</button>
              <button id="copy-fb_m" class="px-3 py-1 rounded-full text-xs border" type="button">Copy</button>
              <button id="publish-fb_m" class="px-3 py-1 rounded-full text-xs border" type="button">Open Composer</button>
            </div>
          </div>
          <pre id="out-fb_m" class="whitespace-pre-wrap text-sm mt-3"></pre>
        </div>

        <!-- Quora -->
        <div class="card p-5">
          <div class="flex justify-between items-center gap-2 flex-wrap">
            <strong class="tracking-tight inline-flex items-center gap-2">Quora</strong>
            <div class="flex items-center gap-2">
              <button id="optimize-quora_m" class="px-3 py-1 rounded-full text-xs border" type="button">Optimize</button>
              <button id="copy-quora_m" class="px-3 py-1 rounded-full text-xs border" type="button">Copy</button>
              <button id="publish-quora_m" class="px-3 py-1 rounded-full text-xs border" type="button">Open Quora</button>
            </div>
          </div>
          <div class="text-xs text-slate-400">Question ideas</div>
          <ul id="quora-qs_m" class="mt-1 text-sm space-y-1"></ul>
          <pre id="out-quora_m" class="whitespace-pre-wrap text-sm mt-3"></pre>
        </div>

        <!-- LinkedIn Article -->
        <div class="card p-5">
          <div class="flex justify-between items-center gap-2 flex-wrap">
            <strong class="tracking-tight inline-flex items-center gap-2">LinkedIn Article</strong>
            <div class="flex items-center gap-2">
              <button id="optimize-li-article_m" class="px-3 py-1 rounded-full text-xs border" type="button">Optimize</button>
              <button id="copy-li-article_m" class="px-3 py-1 rounded-full text-xs border" type="button">Copy</button>
              <button id="publish-li-article_m" class="px-3 py-1 rounded-full text-xs border" type="button">Open Publisher</button>
            </div>
          </div>
          <pre id="out-li-article_m" class="whitespace-pre-wrap text-sm mt-3"></pre>
        </div>
      </div>

      <!-- Article Optimizer -->
      <section id="article-optimizer" class="card p-6 mt-6">
        <div class="flex items-center justify-between gap-3 flex-wrap">
          <h3 class="text-xl font-bold tracking-tight">Article Optimizer</h3>
          <span id="ao_status" class="text-sm text-slate-500"></span>
        </div>

        <div class="grid lg:grid-cols-2 gap-5 mt-4">
          <div>
            <label for="ao_source_url" class="text-xs text-slate-500">Source URL (optional)</label>
            <input id="ao_source_url" class="mt-1 w-full p-2 rounded-xl border border-slate-200/70 dark:bg-black/30" placeholder="https://example.com/article" />
            <label for="ao_source" class="text-xs text-slate-500 mt-4 block">Or paste article text</label>
            <textarea id="ao_source" class="mt-1 w-full h-56 p-3 rounded-xl border border-slate-200/70 focus:outline-none focus:ring-2 focus:ring-slate-300 dark:bg-black/30" placeholder="Paste full article…"></textarea>

            <div class="mt-4">
              <div class="text-xs text-slate-500 mb-2">Optimize for</div>
              <div class="flex flex-wrap gap-2">
                <label class="chip"><input id="ao_opt_humanize" type="checkbox" class="sr-only"> Humanize</label>
                <label class="chip"><input id="ao_opt_lengthen" type="checkbox" class="sr-only"> Lengthen</label>
                <label class="chip"><input id="ao_opt_addfaqs" type="checkbox" class="sr-only"> Add FAQs</label>
                <label class="chip"><input id="ao_opt_reoutline" type="checkbox" class="sr-only"> Re-outline</label>
                <label class="chip"><input id="ao_opt_headings" type="checkbox" class="sr-only"> Auto headings</label>
                <label class="chip"><input id="ao_opt_seo" type="checkbox" class="sr-only"> SEO pass</label>
              </div>
            </div>

            <div class="mt-4 flex flex-wrap items-center gap-3">
              <button id="ao_run" class="px-4 py-2 rounded-xl font-semibold text-white bg-black hover:opacity-90" type="button">Optimize</button>
              <button id="ao_run_byok" class="px-4 py-2 rounded-xl font-semibold text-white bg-emerald-600 hover:opacity-90" type="button">Optimize with BYOK</button>
              <button id="ao_to_drafts" class="px-4 py-2 rounded-xl font-semibold border border-slate-300/60 hover:bg-white/50" type="button">Generate Drafts for Selected Channels</button>
            </div>
          </div>

          <div>
            <div class="flex items-center justify-between gap-2">
              <strong class="tracking-tight">Optimized HTML</strong>
              <div class="flex items-center gap-2">
                <button id="ao_copy_html" class="px-3 py-1 rounded-full text-xs border" type="button">Copy</button>
                <button id="ao_download_html" class="px-3 py-1 rounded-full text-xs border" type="button">Download .html</button>
                <button id="ao-notion" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Export to Notion</button>
                <button id="ao-trello" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Send to Trello</button>
                <button id="ao-buffer" class="px-3 py-1 rounded-full text-xs border hidden" type="button">Queue in Buffer</button>
              </div>
            </div>
            <div id="ao_html" class="mt-3 p-4 rounded-xl border border-slate-200/70 dark:bg-black/30 text-sm overflow-auto" style="min-height: 16rem;"></div>
          </div>
        </div>
      </section>

      <!-- Scheduler (Starter+) -->
      <section id="schedulerCard" class="card p-6 mt-6">
        <div class="flex items-center justify-between gap-3 flex-wrap">
          <h3 class="text-lg font-bold">Scheduler</h3>
          <small class="text-slate-500">Starter+: schedule posts across channels</small>
        </div>

        <div class="grid md:grid-cols-2 gap-4 mt-3">
          <div>
            <label class="text-xs text-slate-500">Title</label>
            <input id="sch_title" class="mt-1 w-full p-2 rounded-xl border border-slate-200/70 dark:bg-black/30" placeholder="e.g., Launch post" />

            <div class="mt-3">
              <div class="text-xs text-slate-500 mb-2">Channels</div>
              <div id="sch_channels" class="flex flex-wrap gap-2">
                <button class="chip" data-channel="linkedin">LinkedIn</button>
                <button class="chip" data-channel="x">X</button>
                <button class="chip" data-channel="instagram">Instagram</button>
                <button class="chip" data-channel="email">Email</button>
                <button class="chip" data-channel="tiktok">TikTok</button>
                <button class="chip" data-channel="facebook">Facebook</button>
                <button class="chip" data-channel="reddit">Reddit</button>
                <button class="chip" data-channel="quora">Quora</button>
              </div>
            </div>

            <div class="grid sm:grid-cols-2 gap-3 mt-3">
              <div>
                <label class="text-xs text-slate-500">Start time</label>
                <input id="sch_start" type="datetime-local" class="mt-1 w-full p-2 rounded-xl border border-slate-200/70 dark:bg-black/30" />
              </div>
              <div>
                <label class="text-xs text-slate-500">Timezone</label>
                <select id="sch_tz" class="mt-1 w-full p-2 rounded-xl border border-slate-200/70 dark:bg-black/30">
                  <option value="local">Local</option>
                  <option value="UTC">UTC</option>
                </select>
              </div>
            </div>

            <div class="grid sm:grid-cols-2 gap-3 mt-3">
              <div>
                <label class="text-xs text-slate-500">Repeat</label>
                <select id="sch_rrule_select" class="mt-1 w-full p-2 rounded-xl border border-slate-200/70 dark:bg-black/30">
                  <option value="">Once</option>
                  <option value="DAILY">Daily</option>
                  <option value="WEEKLY">Weekly</option>
                  <option value="MONTHLY">Monthly</option>
                  <option value="CUSTOM">Custom RRULE</option>
                </select>
              </div>
              <div>
                <label class="text-xs text-slate-500">Custom RRULE (optional)</label>
                <input id="sch_rrule_input" class="mt-1 w-full p-2 rounded-xl border border-slate-200/70 dark:bg-black/30" placeholder="RRULE:FREQ=WEEKLY;BYDAY=MO,TH;BYHOUR=9" />
              </div>
            </div>

            <div class="mt-4 flex items-center gap-2">
              <button id="sch_add" class="px-4 py-2 rounded-xl font-semibold text-white bg-black hover:opacity-90" type="button">Add schedule</button>
              <span id="sch_msg" class="text-sm text-slate-500"></span>
            </div>
          </div>

          <div>
            <div class="flex items-center justify-between">
              <strong>Upcoming</strong>
              <button id="sch_refresh" class="px-3 py-1 rounded-full text-xs border" type="button">Refresh</button>
            </div>
            <ul id="sch_list" class="mt-3 text-sm space-y-2"></ul>
          </div>
        </div>
      </section>

      <!-- Analytics (Starter+) -->
      <section id="analyticsCard" class="card p-6 mt-6">
        <div class="flex items-center justify-between gap-3 flex-wrap">
          <h3 class="text-lg font-bold">Analytics</h3>
          <div class="flex items-center gap-2">
            <select id="ana_range" class="p-2 rounded-xl border border-slate-200/70 dark:bg-black/30">
              <option value="7d">Last 7 days</option>
              <option value="30d">Last 30 days</option>
              <option value="90d">Last 90 days</option>
            </select>
            <div id="ana_channels" class="hidden"></div>
          </div>
        </div>

        <div class="grid md:grid-cols-3 gap-4 mt-4">
          <div class="md:col-span-2">
            <div id="anaChart" class="h-64 rounded-xl border border-white/10 flex items-center justify-center text-sm text-slate-500">
              Chart loads here
            </div>
          </div>
          <div>
            <div id="anaSummary" class="grid grid-cols-2 gap-3">
              <div class="p-3 rounded-xl border">
                <div class="text-xs text-slate-500">Posts</div>
                <div id="ana_posts" class="text-xl font-bold">0</div>
              </div>
              <div class="p-3 rounded-xl border">
                <div class="text-xs text-slate-500">Reach</div>
                <div id="ana_reach" class="text-xl font-bold">–</div>
              </div>
              <div class="p-3 rounded-xl border">
                <div class="text-xs text-slate-500">CTR</div>
                <div id="ana_ctr" class="text-xl font-bold">–</div>
              </div>
              <div class="p-3 rounded-xl border">
                <div class="text-xs text-slate-500">Saves</div>
                <div id="ana_saves" class="text-xl font-bold">–</div>
              </div>
            </div>
          </div>
        </div>

        <div class="mt-4">
          <div class="text-sm font-semibold mb-2">Recent performance</div>
          <div id="anaTable" class="rounded-xl border overflow-x-auto"></div>
        </div>
      </section>

      <!-- Saved Presets + Growth -->
      <div class="grid md:grid-cols-2 gap-5 mt-6">
        <!-- Saved Presets -->
        <div class="card p-5">
          <div class="flex items-center justify-between">
            <strong>Saved presets</strong>
            <button id="addPreset" class="px-3 py-1 rounded-xl border" type="button">Save current</button>
          </div>
          <p class="text-xs text-slate-500 mt-2">Free: 0 • Solo Creator: 10 • Creator/Business: Unlimited</p>
          <ul id="presetList" class="mt-3 text-sm space-y-2"></ul>
        </div>
        <!-- Growth / Referrals -->
        <div class="card p-5">
          <strong>Grow your daily quota</strong>
          <p class="text-sm text-slate-500 mt-2">Share your invite to unlock bonus runs (visual; enforcement handled by Worker).</p>
          <div class="mt-3 grid gap-2">
            <input id="refLink" class="p-2 rounded-xl border border-slate-200/70 dark:bg-black/30" readonly value="">
            <div class="flex flex-wrap gap-2">
              <button id="shareLi" class="px-3 py-2 rounded-xl border" type="button">Share on LinkedIn</button>
              <button id="shareX" class="px-3 py-2 rounded-xl border" type="button">Share on X</button>
              <button id="copyRef" class="px-3 py-2 rounded-xl border" type="button">Copy link</button>
            </div>
          </div>
          <p id="refNote" class="text-xs text-slate-500 mt-2">Referrals this month: <span id="refCount">0</span></p>
        </div>
      </div>

      <!-- Plan Features -->
      <div class="card p-6 mt-6">
        <h3 class="text-lg font-bold">Your plan includes</h3>
        <ul id="featureList" class="mt-3 text-sm space-y-1"></ul>
      </div>

      <!-- Integrations -->
      <div class="card p-6 mt-6" id="integrationsCard">
        <h3 class="text-lg font-bold">Integrations</h3>
        <div class="grid md:grid-cols-3 gap-4 mt-3">
          <div class="p-4 rounded-xl border">
            <div class="flex items-center justify-between">
              <strong>Notion</strong><span id="notionState" class="chip">Disconnected</span>
            </div>
            <p class="text-xs text-slate-500 mt-1">Export pages to your workspace.</p>
            <div class="mt-3 flex gap-2">
              <button id="connectNotion" class="btn" type="button">Connect</button>
              <button id="disconnectNotion" class="btn hidden" type="button">Disconnect</button>
            </div>
          </div>
          <div class="p-4 rounded-xl border">
            <div class="flex items-center justify-between">
              <strong>Trello</strong><span id="trelloState" class="chip">Disconnected</span>
            </div>
            <p class="text-xs text-slate-500 mt-1">Send drafts as cards.</p>
            <div class="mt-3 flex gap-2">
              <button id="connectTrello" class="btn" type="button">Connect</button>
              <button id="disconnectTrello" class="btn hidden" type="button">Disconnect</button>
            </div>
          </div>
          <div class="p-4 rounded-xl border">
            <div class="flex items-center justify-between">
              <strong>Buffer</strong><span id="bufferState" class="chip">Disconnected</span>
            </div>
            <p class="text-xs text-slate-500 mt-1">Queue posts to social profiles.</p>
            <div class="mt-3 flex gap-2">
              <button id="connectBuffer" class="btn" type="button">Connect</button>
              <button id="disconnectBuffer" class="btn hidden" type="button">Disconnect</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Team (Business) -->
      <div class="card p-6 mt-6" id="teamCard">
        <h3 class="text-lg font-bold">Team (Business)</h3>
        <div class="mt-2 flex gap-2">
          <input id="inviteEmail" class="w-full p-2 rounded-xl border flex-1" placeholder="teammate@company.com">
          <button id="inviteBtn" class="btn" type="button">Invite member</button>
        </div>
        <ul id="seatList" class="mt-3 text-sm space-y-1"></ul>
        <div class="mt-4 text-xs text-slate-500">Content Calendar (Coming Soon)</div>
      </div>
    </div>
  </section>
<script>
(() => {
  // ------------------------------
  // Helpers & global state
  // ------------------------------
  const $ = (sel, root = document) => root.querySelector(sel);
  const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));
  const byId = (id) => document.getElementById(id);
  const sleep = (ms) => new Promise(r => setTimeout(r, ms));

  const state = {
    session: null,
    outputs_demo: {},
    outputs_member: {},
    integrations: { notion: false, trello: false, buffer: false },
    demoRunCount: 0,
    lastRange: '7d',
    channelsDefault: ['linkedin','x','email','instagram'],
    ref: { link: '', count: 0 },
    byok: { provider: '', key: '', base: '', model: '' },
    plan: 'Free',
    quotas: { anonMonthlyCap: 5, authDailyCap: 5, today: 0, month: 0 },
    // feature flags from backend (if any)
    features: {}
  };

  const API = {
    session: '/api/auth/session',
    login: '/api/auth/login',
    logout: '/api/auth/logout',
    usage: '/api/usage',
    generate: '/api/generate',
    batch: '/api/batch/generate',
    optimize: '/api/optimize',
    optimizerArticle: '/api/optimizer/article',
    billingCheckout: '/api/billing/checkout',
    billingPortal: '/api/billing/portal',
    scheduler: '/api/scheduler',
    analytics: '/api/analytics',
    presets: '/api/presets',
    teamInvite: '/api/team/invite',
    teamList: '/api/team/list',
    integrationsStatus: '/api/integrations/status',
    integrations: {
      notion: {
        start: '/api/integrations/notion/oauth/start',
        disconnect: '/api/integrations/notion/disconnect',
        export: '/api/export/notion'
      },
      trello: {
        start: '/api/integrations/trello/oauth/start',
        disconnect: '/api/integrations/trello/disconnect',
        export: '/api/export/trello'
      },
      buffer: {
        start: '/api/integrations/buffer/oauth/start',
        disconnect: '/api/integrations/buffer/disconnect',
        queue: '/api/export/buffer'
      }
    }
  };

  async function fetchJSON(url, opts = {}) {
    try {
      const res = await fetch(url, { credentials: 'include', ...opts });
      const ct = res.headers.get('content-type') || '';
      const data = ct.includes('application/json') ? await res.json() : await res.text();
      if (!res.ok) {
        return { ok: false, status: res.status, error: (data && data.error) || data || 'Request failed' };
      }
      return { ok: true, status: res.status, data, headers: res.headers };
    } catch (e) {
      return { ok: false, status: 0, error: e.message || String(e) };
    }
  }

  function notify(msg, type = 'info', timeout = 2800) {
    let wrap = byId('toastWrap');
    if (!wrap) {
      wrap = document.createElement('div');
      wrap.id = 'toastWrap';
      wrap.style.position = 'fixed';
      wrap.style.bottom = '16px';
      wrap.style.right = '16px';
      wrap.style.zIndex = '9999';
      wrap.style.display = 'grid';
      wrap.style.gap = '8px';
      document.body.appendChild(wrap);
    }
    const el = document.createElement('div');
    el.textContent = msg;
    el.setAttribute('role', 'status');
    el.style.padding = '10px 14px';
    el.style.borderRadius = '12px';
    el.style.border = '1px solid rgba(0,0,0,.08)';
    el.style.backdropFilter = 'blur(6px)';
    el.style.fontSize = '14px';
    el.style.boxShadow = '0 6px 20px rgba(0,0,0,.12)';
    el.style.background = type === 'error' ? '#fee2e2' : type === 'success' ? '#dcfce7' : 'rgba(255,255,255,.9)';
    wrap.appendChild(el);
    setTimeout(() => el.remove(), timeout);
  }

  function upsellModal() {
    let modal = byId('upsellModal');
    if (modal) return modal;
    modal = document.createElement('div');
    modal.id = 'upsellModal';
    modal.className = 'fixed inset-0 z-[9998] hidden';
    modal.innerHTML = `
      <div class="absolute inset-0 bg-black/50"></div>
      <div class="absolute inset-0 flex items-center justify-center p-4">
        <div class="max-w-lg w-full rounded-2xl border bg-white/90 dark:bg-black/70 backdrop-blur-xl p-6">
          <h3 class="text-xl font-bold">Unlock 5 daily runs + publishing</h3>
          <p class="text-slate-600 dark:text-slate-300 mt-2">You’ve tried the demo. Sign in to get 5 daily AI repurposes, the article optimizer, scheduling, analytics, and integrations.</p>
          <ul class="mt-3 text-sm list-disc pl-5 text-slate-600 dark:text-slate-300">
            <li>Daily quota: <strong>5</strong> (vs. 5 / month in demo)</li>
            <li>LinkedIn, X, Instagram, Email, TikTok, Reddit, Facebook, Quora + Articles</li>
            <li>Scheduler, Analytics, Notion/Trello/Buffer exports</li>
          </ul>
          <div class="mt-5 flex flex-wrap gap-2">
            <button id="upsellLogin" class="px-4 py-2 rounded-xl font-semibold text-white bg-black">Sign in</button>
            <button id="upsellUpgrade" class="px-4 py-2 rounded-xl font-semibold border">See plans</button>
            <button id="upsellClose" class="ml-auto px-3 py-2 rounded-xl border">Close</button>
          </div>
        </div>
      </div>
    `;
    document.body.appendChild(modal);
    byId('upsellClose').onclick = () => modal.classList.add('hidden');
    byId('upsellLogin').onclick = () => startLogin();
    byId('upsellUpgrade').onclick = () => openCheckout('starter');
    return modal;
  }

  function showUpsell() {
    upsellModal().classList.remove('hidden');
  }

  function selectedChannels(containerSel) {
    const pills = $$('.channel-pill, .chip[data-channel]', $(containerSel) || document);
    const list = pills.filter(p => (p.getAttribute('aria-pressed') === 'true') || p.classList.contains('selected'))
                      .map(p => p.dataset.channel).filter(Boolean);
    return list.length ? list : [...state.channelsDefault];
  }

  function togglePill(el) {
    const pressed = el.getAttribute('aria-pressed');
    if (pressed === 'true') el.setAttribute('aria-pressed', 'false');
    else el.setAttribute('aria-pressed', 'true');
    el.classList.toggle('ring-1');
  }

  function setText(id, text) { const el = byId(id); if (el) el.textContent = text ?? ''; }
  function setHTML(id, html) { const el = byId(id); if (el) el.innerHTML = html ?? ''; }
  async function copyText(text) {
    try { await navigator.clipboard.writeText(text); notify('Copied to clipboard', 'success'); }
    catch { notify('Copy failed', 'error'); }
  }

  function monthKey() {
    const d = new Date();
    return `${d.getUTCFullYear()}-${String(d.getUTCMonth()+1).padStart(2,'0')}`;
    }

  function getDemoRuns() {
    const key = `demo_runs_${monthKey()}`;
    return Number(localStorage.getItem(key) || '0');
  }
  function incDemoRuns() {
    const key = `demo_runs_${monthKey()}`;
    const n = getDemoRuns() + 1;
    localStorage.setItem(key, String(n));
    return n;
  }

  function ensureNoThrow(fn) {
    try { fn(); } catch (e) { /* swallow to avoid breaking page */ }
  }

  // ------------------------------
  // Auth & Billing
  // ------------------------------
  async function loadSession() {
    const r = await fetchJSON(API.session);
    if (!r.ok) return null;
    state.session = r.data?.user ? r.data : null;
    if (state.session?.ref) state.ref = r.data.ref;
    if (state.session?.byok) state.byok = r.data.byok;
    if (state.session?.plan) state.plan = r.data.plan;
    if (state.session?.features) state.features = r.data.features || {};
    if (state.session?.integrations) state.integrations = r.data.integrations;
    return state.session;
  }

  function applySessionUI() {
    const isAuthed = !!state.session?.user;
    const demoView = byId('demoView');
    const memberView = byId('memberView');
    if (demoView) demoView.classList.toggle('hidden', isAuthed);
    if (memberView) memberView.classList.toggle('hidden', !isAuthed);

    if (isAuthed) {
      setText('userEmail', state.session.user.email || '');
      setText('memberPlanBadge', `Plan: ${state.plan || 'Free'}`);
      if (byId('manageBilling2')) byId('manageBilling2').classList.toggle('hidden', !state.session?.billingPortal);
      if (byId('quotaMember')) setText('quotaMember', `Today: ${state.session?.quotas?.today || 0}/${state.session?.quotas?.authDailyCap || state.quotas.authDailyCap}`);
      if (byId('wlLabel')) byId('wlLabel').classList.remove('hidden');
      if (byId('exportPack')) byId('exportPack').classList.remove('hidden');
      // Integrations states
      setIntegrationChips();
      // Preset, Team, Feature lists
      loadPresets();
      loadTeam();
      renderFeatureList();
      // Referral link
      if (byId('refLink')) byId('refLink').value = state.ref.link || `${location.origin}?ref=${encodeURIComponent(state.session.user.id || '')}`;
      if (byId('refCount')) setText('refCount', state.ref.count || 0);
    } else {
      // Demo quotas
      updateDemoQuotaUI();
    }
  }

  async function startLogin() {
    const r = await fetchJSON(API.login, { method: 'POST' });
    if (r.ok && r.data?.url) {
      location.href = r.data.url; // redirect to provider
    } else {
      // Fallback: navigate to endpoint if it handles redirect
      location.href = API.login;
    }
  }

  async function startLogout() {
    const r = await fetchJSON(API.logout, { method: 'POST' });
    if (r.ok) location.reload();
    else notify('Sign out failed', 'error');
  }

  async function openCheckout(plan='starter') {
    const r = await fetchJSON(`${API.billingCheckout}?plan=${encodeURIComponent(plan)}`, { method: 'POST' });
    if (r.ok && r.data?.url) location.href = r.data.url;
    else notify(r.error || 'Could not start checkout', 'error');
  }

  async function openBillingPortal() {
    const r = await fetchJSON(API.billingPortal, { method: 'POST' });
    if (r.ok && r.data?.url) location.href = r.data.url;
    else notify(r.error || 'Billing portal unavailable', 'error');
  }

  // ------------------------------
  // Quotas
  // ------------------------------
  function updateDemoQuotaUI() {
    const runs = getDemoRuns();
    const cap = state.quotas.anonMonthlyCap;
    const left = Math.max(0, cap - runs);
    const badge = byId('quotaDemo');
    if (badge) badge.textContent = `This month: ${runs}/${cap}`;
    const banner = byId('demoCapBanner');
    if (banner) {
      banner.textContent = left <= 0 ? 'Monthly demo limit reached. Sign in for 5 daily runs.' : `You have ${left} demo runs left this month.`;
    }
  }

  async function refreshUsage() {
    const r = await fetchJSON(API.usage);
    if (!r.ok) return;
    const u = r.data || {};
    state.quotas.anonMonthlyCap = Number(u.anonMonthlyCap ?? state.quotas.anonMonthlyCap);
    state.quotas.authDailyCap = Number(u.authDailyCap ?? state.quotas.authDailyCap);
    if (state.session?.user) {
      if (byId('quotaMember')) setText('quotaMember', `Today: ${u.today || 0}/${u.authDailyCap || state.quotas.authDailyCap}`);
      renderQuotaCards(u);
    } else {
      updateDemoQuotaUI();
    }
  }

  function renderQuotaCards(u) {
    const cont = byId('quotaCards');
    if (!cont) return;
    const items = [
      { label: 'Today', value: `${u.today || 0}/${u.authDailyCap || state.quotas.authDailyCap}` },
      { label: 'Batch lines/run', value: u.batchLimit || (state.plan === 'Business' ? 'Unlimited' : state.plan === 'Creator' ? 20 : 10) },
      { label: 'Saved presets', value: u.presets || 0 },
      { label: 'Seats', value: u.seats ? `${u.seats.used}/${u.seats.max}` : (state.plan === 'Business' ? '5' : '1') }
    ];
    cont.innerHTML = items.map(it => `
      <div class="p-4 rounded-xl border">
        <div class="text-xs text-slate-500">${it.label}</div>
        <div class="text-xl font-bold">${it.value}</div>
      </div>
    `).join('');
  }

  // ------------------------------
  // Channel pills & common bindings
  // ------------------------------
  function bindChannelPills() {
    $$('#channelSelector .channel-pill, #channelSelector_m .channel-pill, #sch_channels .chip').forEach(p => {
      p.addEventListener('click', () => {
        if (p.classList.contains('chip') && p.dataset.channel) {
          p.classList.toggle('selected');
          p.classList.toggle('ring-1');
        } else {
          togglePill(p);
        }
      });
    });
  }

  // ------------------------------
  // Demo generator
  // ------------------------------
  async function runDemo(byok = false) {
    const src = byId('source_d')?.value?.trim();
    if (!src) { notify('Add some source text or a URL first.', 'error'); return; }
    const channels = selectedChannels('#channelSelector') || state.channelsDefault;

    // Enforce client-side soft cap; server enforces hard cap
    const used = getDemoRuns();
    if (used >= state.quotas.anonMonthlyCap) {
      showUpsell();
      notify('Monthly demo cap reached. Sign in to continue.', 'error');
      return;
    }
    setText('status_d', 'Generating…');

    const body = {
      mode: 'demo',
      channels,
      source: src,
      byok: byok ? collectBYOK('_d') : null
    };
    const r = await fetchJSON(API.generate, {
      method: 'POST',
      headers: { 'content-type': 'application/json' },
      body: JSON.stringify(body)
    });
    if (!r.ok) {
      setText('status_d', '');
      notify(r.error || 'Generation failed', 'error');
      return;
    }
    state.outputs_demo = r.data || {};
    paintOutputs('d', state.outputs_demo);
    setText('status_d', 'Done.');

    const n = incDemoRuns();
    updateDemoQuotaUI();
    if (n >= 2) showUpsell();
  }

  function paintOutputs(suffix, outputs) {
    const map = {
      linkedin: `out-li_${suffix}`,
      x: `out-x_${suffix}`,
      email_subject: `out-em-subj_${suffix}`,
      email_body: `out-em-body_${suffix}`,
      instagram: `out-ig_${suffix}`,
      tiktok: `out-tt_${suffix}`,
      reddit: `out-reddit_${suffix}`,
      facebook: `out-fb_${suffix}`,
      quora: `out-quora_${suffix}`,
      quora_questions: `quora-qs_${suffix}`,
      li_article: `out-li-article_${suffix}`
    };
    if (outputs.linkedin) setText(map.linkedin, outputs.linkedin);
    if (outputs.x) setText(map.x, outputs.x);
    if (outputs.email?.subject) setText(map.email_subject, outputs.email.subject);
    if (outputs.email?.body) setText(map.email_body, outputs.email.body);
    if (outputs.instagram) setText(map.instagram, outputs.instagram);
    if (outputs.tiktok) setText(map.tiktok, outputs.tiktok);
    if (outputs.reddit) setText(map.reddit, outputs.reddit);
    if (outputs.facebook) setText(map.facebook, outputs.facebook);
    if (outputs.quora?.post) setText(map.quora, outputs.quora.post);
    if (Array.isArray(outputs.quora?.ideas)) {
      const ul = byId(map.quora_questions);
      if (ul) ul.innerHTML = outputs.quora.ideas.map(q => `<li>• ${escapeHtml(q)}</li>`).join('');
    }
    if (outputs.li_article) setText(map.li_article, outputs.li_article);
  }

  function escapeHtml(s='') {
    return s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
  }

  function collectBYOK(suffix = '_m') {
    const model = byId(`model${suffix}`)?.value?.trim() || '';
    const provider = byId(`byok_provider${suffix}`)?.value || '';
    const key = byId(`byok_key${suffix}`)?.value?.trim() || '';
    const base = byId(`byok_base${suffix}`)?.value?.trim() || '';
    return { model, provider, key, base };
  }

  // ------------------------------
  // Member generator
  // ------------------------------
  async function runMember(byok = false) {
    const src = byId('source_m')?.value?.trim();
    if (!src) { notify('Add some source text or a URL first.', 'error'); return; }
    const channels = selectedChannels('#channelSelector_m');
    setText('status_m', 'Generating…');

    const body = {
      mode: 'member',
      channels,
      source: src,
      whitelabel: !!byId('whitelabel')?.checked,
      byok: byok ? collectBYOK('_m') : null
    };
    const r = await fetchJSON(API.generate, {
      method: 'POST',
      headers: { 'content-type': 'application/json' },
      body: JSON.stringify(body)
    });
    if (!r.ok) {
      setText('status_m', '');
      notify(r.error || 'Generation failed', 'error');
      return;
    }
    state.outputs_member = r.data || {};
    paintOutputs('m', state.outputs_member);
    setText('status_m', 'Done.');
    refreshUsage();
  }

  async function saveBYOKToAccount() {
    const payload = { byok: collectBYOK('_m') };
    const r = await fetchJSON('/api/account/byok', {
      method: 'POST',
      headers: { 'content-type': 'application/json' },
      body: JSON.stringify(payload)
    });
    if (r.ok) notify('Saved to your account', 'success');
    else notify(r.error || 'Could not save', 'error');
  }

  // ------------------------------
  // Optimization per channel
  // ------------------------------
  async function optimizeChannel(channel, suffix) {
    const outId = channel === 'email'
      ? [`out-em-subj_${suffix}`, `out-em-body_${suffix}`]
      : [`out-${channel}_${suffix}`];

    const payload = { channel, content: '' };
    if (Array.isArray(outId)) {
      payload.content = {
        subject: byId(outId[0])?.textContent || '',
        body: byId(outId[1])?.textContent || ''
      };
    } else {
      payload.content = byId(outId[0])?.textContent || '';
    }

    const r = await fetchJSON(API.optimize, {
      method: 'POST',
      headers: { 'content-type': 'application/json' },
      body: JSON.stringify(payload)
    });
    if (!r.ok) return notify(r.error || 'Optimize failed', 'error');

    const res = r.data || {};
    if (res.email) {
      setText(outId[0], res.email.subject || '');
      setText(outId[1], res.email.body || '');
    } else if (res.channel && res.text) {
      setText(outId[0], res.text);
    } else if (typeof res === 'string') {
      setText(outId[0], res);
    }
    notify('Optimized', 'success');
  }

  // ------------------------------
  // Article Optimizer
  // ------------------------------
  async function runArticleOptimizer(byok = false) {
    const url = byId('ao_source_url')?.value?.trim();
    const text = byId('ao_source')?.value?.trim();
    if (!url && !text) { notify('Provide a URL or paste article text', 'error'); return; }
    setText('ao_status', 'Optimizing…');

    const opts = {
      humanize: byId('ao_opt_humanize')?.checked || false,
      lengthen: byId('ao_opt_lengthen')?.checked || false,
      addfaqs: byId('ao_opt_addfaqs')?.checked || false,
      reoutline: byId('ao_opt_reoutline')?.checked || false,
      headings: byId('ao_opt_headings')?.checked || false,
      seo: byId('ao_opt_seo')?.checked || false
    };

    const body = {
      url: url || null,
      html: text || null,
      byok: byok ? collectBYOK('_m') : null,
      options: opts
    };

    const r = await fetchJSON(API.optimizerArticle, {
      method: 'POST',
      headers: { 'content-type':'application/json' },
      body: JSON.stringify(body)
    });
    if (!r.ok) { setText('ao_status', ''); notify(r.error || 'Optimizer failed','error'); return; }
    const html = r.data?.html || '';
    setHTML('ao_html', html);
    setText('ao_status', 'Done.');
  }

  function downloadOptimizedHTML() {
    const html = byId('ao_html')?.innerHTML || '';
    const blob = new Blob([`<!doctype html><html><head><meta charset="utf-8"><title>Optimized Article</title></head><body>${html}</body></html>`], {type:'text/html'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'optimized-article.html';
    document.body.appendChild(a); a.click(); a.remove();
    URL.revokeObjectURL(url);
  }

  // ------------------------------
  // Scheduler
  // ------------------------------
  function collectScheduleChannels() {
    const pills = $$('#sch_channels .chip.selected');
    return pills.map(p => p.dataset.channel);
  }

  async function addSchedule() {
    const title = byId('sch_title')?.value?.trim();
    const start = byId('sch_start')?.value;
    const tz = byId('sch_tz')?.value || 'local';
    const rsel = byId('sch_rrule_select')?.value || '';
    const rinput = byId('sch_rrule_input')?.value?.trim() || '';
    const channels = collectScheduleChannels();
    if (!title || !start || !channels.length) {
      setText('sch_msg', 'Title, start time, and at least one channel required');
      return;
    }
    setText('sch_msg', 'Adding…');
    const payload = { title, start, tz, channels, rrule: rsel === 'CUSTOM' ? rinput : rsel };
    const r = await fetchJSON(API.scheduler, {
      method:'POST',
      headers:{'content-type':'application/json'},
      body: JSON.stringify(payload)
    });
    if (!r.ok) { setText('sch_msg', r.error || 'Failed'); return; }
    setText('sch_msg', 'Scheduled');
    await sleep(400);
    setText('sch_msg', '');
    refreshSchedules();
  }

  async function refreshSchedules() {
    const r = await fetchJSON(API.scheduler);
    if (!r.ok) return;
    const list = r.data?.items || [];
    const ul = byId('sch_list');
    if (!ul) return;
    ul.innerHTML = list.length ? '' : '<li class="text-slate-500">No upcoming items</li>';
    list.forEach(item => {
      const li = document.createElement('li');
      li.className = 'p-3 rounded-xl border flex items-center justify-between gap-3';
      li.innerHTML = `
        <div>
          <div class="font-medium">${escapeHtml(item.title || 'Untitled')}</div>
          <div class="text-xs text-slate-500">${new Date(item.start).toLocaleString()} • ${escapeHtml((item.channels || []).join(', '))}</div>
        </div>
        <div class="flex gap-2">
          <button data-id="${item.id}" class="px-3 py-1 rounded-full text-xs border sch-cancel">Cancel</button>
        </div>
      `;
      ul.appendChild(li);
    });
    $$('.sch-cancel', ul).forEach(btn => btn.addEventListener('click', async () => {
      const id = btn.dataset.id;
      const r = await fetchJSON(`${API.scheduler}/${encodeURIComponent(id)}`, { method:'DELETE' });
      if (r.ok) { notify('Cancelled','success'); refreshSchedules(); } else notify(r.error || 'Cancel failed','error');
    }));
  }

  // ------------------------------
  // Analytics
  // ------------------------------
  async function refreshAnalytics(range = '7d') {
    state.lastRange = range;
    const r = await fetchJSON(`${API.analytics}?range=${encodeURIComponent(range)}`);
    if (!r.ok) return;
    const data = r.data || { series: [], table: [] };
    renderAnalyticsChart(data.series || []);
    renderAnalyticsSummary(data.series || []);
    renderAnalyticsTable(data.table || []);
  }

  function renderAnalyticsChart(series) {
    const wrap = byId('anaChart');
    if (!wrap) return;
    if (!series.length) { wrap.textContent = 'No data yet'; return; }
    // Build a minimalist SVG line chart (no external libs)
    const width = wrap.clientWidth || 600;
    const height = wrap.clientHeight || 220;
    const pad = 24;
    const xs = series.map((_, i) => i);
    const ys = series.map(d => Number(d.posts || 0));
    const maxY = Math.max(1, ...ys);
    const pts = ys.map((y, i) => {
      const x = pad + (i * (width - pad*2)) / Math.max(1, series.length - 1);
      const yp = height - pad - (y / maxY) * (height - pad*2);
      return `${x},${yp}`;
    }).join(' ');
    wrap.innerHTML = `
      <svg width="${width}" height="${height}" role="img" aria-label="Posts over time">
        <polyline points="${pts}" fill="none" stroke="currentColor" stroke-width="2" opacity="0.9"></polyline>
      </svg>
    `;
  }

  function renderAnalyticsSummary(series) {
    const totalPosts = series.reduce((a, b) => a + Number(b.posts || 0), 0);
    const reach = series.reduce((a, b) => a + Number(b.reach || 0), 0);
    const clicks = series.reduce((a, b) => a + Number(b.clicks || 0), 0);
    const ctr = reach > 0 ? ((clicks / reach) * 100).toFixed(1) + '%' : '–';
    setText('ana_posts', totalPosts);
    setText('ana_reach', reach ? reach.toLocaleString() : '–');
    setText('ana_ctr', ctr);
    setText('ana_saves', (series.reduce((a,b)=>a+Number(b.saves||0),0)) || '–');
  }

  function renderAnalyticsTable(rows) {
    const cont = byId('anaTable');
    if (!cont) return;
    if (!rows.length) { cont.innerHTML = '<div class="p-4 text-slate-500">No recent posts</div>'; return; }
    cont.innerHTML = `
      <table class="min-w-full text-sm">
        <thead>
          <tr class="text-left border-b">
            <th class="p-3">Date</th>
            <th class="p-3">Channel</th>
            <th class="p-3">Preview</th>
            <th class="p-3">Reach</th>
            <th class="p-3">Clicks</th>
            <th class="p-3">Saves</th>
          </tr>
        </thead>
        <tbody>
          ${rows.map(r => `
            <tr class="border-b">
              <td class="p-3 whitespace-nowrap">${new Date(r.date).toLocaleDateString()}</td>
              <td class="p-3">${escapeHtml(r.channel || '')}</td>
              <td class="p-3 max-w-[360px] truncate" title="${escapeHtml(r.preview || '')}">${escapeHtml(r.preview || '')}</td>
              <td class="p-3">${Number(r.reach || 0).toLocaleString()}</td>
              <td class="p-3">${Number(r.clicks || 0).toLocaleString()}</td>
              <td class="p-3">${Number(r.saves || 0).toLocaleString()}</td>
            </tr>
          `).join('')}
        </tbody>
      </table>
    `;
  }

  // ------------------------------
  // Integrations
  // ------------------------------
  async function checkIntegrations() {
    const r = await fetchJSON(API.integrationsStatus);
    if (!r.ok) return;
    state.integrations = r.data || state.integrations;
    setIntegrationChips();
  }
  function setIntegrationChips() {
    const { notion, trello, buffer } = state.integrations || {};
    if (byId('notionState')) byId('notionState').textContent = notion ? 'Connected' : 'Disconnected';
    if (byId('trelloState')) byId('trelloState').textContent = trello ? 'Connected' : 'Disconnected';
    if (byId('bufferState')) byId('bufferState').textContent = buffer ? 'Connected' : 'Disconnected';
    toggleIntegrationButtons('notion', notion);
    toggleIntegrationButtons('trello', trello);
    toggleIntegrationButtons('buffer', buffer);
    // Show export buttons if connected
    const ids = ['li','x','em','ig','ao'];
    ids.forEach(prefix => {
      if (byId(`${prefix}-notion`)) byId(`${prefix}-notion`).classList.toggle('hidden', !notion);
      if (byId(`${prefix}-trello`)) byId(`${prefix}-trello`).classList.toggle('hidden', !trello);
      if (byId(`${prefix}-buffer`)) byId(`${prefix}-buffer`).classList.toggle('hidden', !buffer);
    });
  }
  function toggleIntegrationButtons(name, connected) {
    const c = byId(`connect${cap(name)}`);
    const d = byId(`disconnect${cap(name)}`);
    if (c) c.classList.toggle('hidden', connected);
    if (d) d.classList.toggle('hidden', !connected);
  }
  function cap(s) { return s.charAt(0).toUpperCase()+s.slice(1); }

  function connectIntegration(name) {
    const cfg = API.integrations[name];
    if (!cfg) return;
    // Redirect to OAuth start
    location.href = cfg.start;
  }
  async function disconnectIntegration(name) {
    const cfg = API.integrations[name];
    if (!cfg) return;
    const r = await fetchJSON(cfg.disconnect, { method:'POST' });
    if (r.ok) { notify('Disconnected','success'); checkIntegrations(); }
    else notify(r.error || 'Disconnect failed','error');
  }

  async function exportTo(dest, payload) {
    const cfg = API.integrations[dest];
    if (!cfg) return notify('Unknown integration', 'error');
    const endpoint = dest === 'buffer' ? cfg.queue : cfg.export;
    const r = await fetchJSON(endpoint, {
      method:'POST',
      headers:{'content-type':'application/json'},
      body: JSON.stringify(payload)
    });
    if (r.ok) notify('Sent successfully','success');
    else notify(r.error || 'Export failed','error');
  }

  // ------------------------------
  // Presets
  // ------------------------------
  function snapshotCurrentPreset() {
    return {
      name: `Preset ${new Date().toLocaleString()}`,
      channels: selectedChannels('#channelSelector_m'),
      byok: collectBYOK('_m')
    };
  }

  async function savePreset() {
    const preset = snapshotCurrentPreset();
    const r = await fetchJSON(API.presets, {
      method:'POST',
      headers:{'content-type':'application/json'},
      body: JSON.stringify(preset)
    });
    if (r.ok) { notify('Preset saved','success'); loadPresets(); }
    else notify(r.error || 'Save failed','error');
  }

  async function loadPresets() {
    const r = await fetchJSON(API.presets);
    if (!r.ok) return;
    const list = r.data?.items || [];
    const ul = byId('presetList');
    if (!ul) return;
    ul.innerHTML = list.length ? '' : '<li class="text-slate-500">No presets yet</li>';
    list.forEach(p => {
      const li = document.createElement('li');
      li.className = 'p-3 rounded-xl border flex items-center justify-between gap-2';
      li.innerHTML = `
        <div class="truncate"><span class="font-medium">${escapeHtml(p.name)}</span> <span class="text-xs text-slate-500">(${escapeHtml((p.channels||[]).join(', '))})</span></div>
        <div class="flex gap-2">
          <button data-id="${p.id}" class="px-3 py-1 rounded-full text-xs border preset-apply">Apply</button>
          <button data-id="${p.id}" class="px-3 py-1 rounded-full text-xs border preset-del">Delete</button>
        </div>
      `;
      ul.appendChild(li);
    });
    $$('.preset-apply', ul).forEach(btn => btn.addEventListener('click', async () => {
      const id = btn.dataset.id;
      const p = (list.find(x => x.id === id)) || null;
      if (!p) return;
      // Apply channels
      $$('#channelSelector_m .channel-pill').forEach(el => {
        const on = p.channels?.includes(el.dataset.channel);
        el.setAttribute('aria-pressed', on ? 'true' : 'false');
        el.classList.toggle('ring-1', !!on);
      });
      // Apply BYOK
      if (p.byok) {
        if (byId('model_m')) byId('model_m').value = p.byok.model || '';
        if (byId('byok_provider_m')) byId('byok_provider_m').value = p.byok.provider || '';
        if (byId('byok_key_m')) byId('byok_key_m').value = p.byok.key || '';
        if (byId('byok_base_m')) byId('byok_base_m').value = p.byok.base || '';
      }
      notify('Preset applied','success');
    }));
    $$('.preset-del', ul).forEach(btn => btn.addEventListener('click', async () => {
      const id = btn.dataset.id;
      const r2 = await fetchJSON(`${API.presets}/${encodeURIComponent(id)}`, { method:'DELETE' });
      if (r2.ok) { notify('Preset deleted','success'); loadPresets(); } else notify(r2.error || 'Delete failed','error');
    }));
  }

  // ------------------------------
  // Team (Business)
  // ------------------------------
  async function loadTeam() {
    const r = await fetchJSON(API.teamList);
    if (!r.ok) return;
    const ul = byId('seatList');
    if (!ul) return;
    const list = r.data?.items || [];
    ul.innerHTML = list.length ? '' : '<li class="text-slate-500">No team members yet</li>';
    list.forEach(m => {
      const li = document.createElement('li');
      li.className = 'p-3 rounded-xl border flex items-center justify-between gap-2';
      li.innerHTML = `
        <div><span class="font-medium">${escapeHtml(m.email)}</span> <span class="text-xs text-slate-500">(${escapeHtml(m.role || 'member')})</span></div>
        <button data-id="${m.id}" class="px-3 py-1 rounded-full text-xs border seat-remove">Remove</button>
      `;
      ul.appendChild(li);
    });
    $$('.seat-remove', ul).forEach(btn => btn.addEventListener('click', async () => {
      const id = btn.dataset.id;
      const r2 = await fetchJSON(`${API.teamList}/${encodeURIComponent(id)}`, { method:'DELETE' });
      if (r2.ok) { notify('Removed','success'); loadTeam(); } else notify(r2.error || 'Action failed','error'); 
    }));
  }

  async function inviteTeamMember() {
    const email = byId('inviteEmail')?.value?.trim();
    if (!email) return notify('Enter an email', 'error');
    const r = await fetchJSON(API.teamInvite, {
      method:'POST',
      headers:{'content-type':'application/json'},
      body: JSON.stringify({ email })
    });
    if (r.ok) { notify('Invite sent','success'); byId('inviteEmail').value=''; loadTeam(); }
    else notify(r.error || 'Invite failed','error');
  }

  // ------------------------------
  // Feature list (plan table)
  // ------------------------------
  function renderFeatureList() {
    const ul = byId('featureList'); if (!ul) return;
    const plan = state.plan || 'Free';
    const items = [
      '5 daily AI repurposes',
      'All channels (LinkedIn, X, Instagram, Email, TikTok, Reddit, Facebook, Quora, LinkedIn Articles)',
      'Article Optimizer (humanize, headings, FAQs, SEO)',
      'Scheduler + basic analytics',
      'Notion, Trello, Buffer integrations',
      'Batch inputs & saved presets'
    ];
    ul.innerHTML = items.map(x => `<li>• ${escapeHtml(x)}</li>`).join('');
  }

  // ------------------------------
  // Growth / referrals
  // ------------------------------
  function wireGrowth() {
    if (byId('copyRef')) byId('copyRef').onclick = () => {
      const v = byId('refLink')?.value || '';
      copyText(v);
    };
    if (byId('shareLi')) byId('shareLi').onclick = () => {
      const v = byId('refLink')?.value || location.href;
      window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(v)}`, '_blank','noopener');
    };
    if (byId('shareX')) byId('shareX').onclick = () => {
      const v = byId('refLink')?.value || location.href;
      const text = 'I’m using ContentRepurpose to turn 1 idea into 9 posts. Try it: ';
      window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(v)}`, '_blank','noopener');
    };
  }

  // ------------------------------
  // Exports / Publishing actions
  // ------------------------------
  function contentFor(channel, suffix) {
    if (channel === 'email') {
      return {
        channel,
        subject: byId(`out-em-subj_${suffix}`)?.textContent || '',
        body: byId(`out-em-body_${suffix}`)?.textContent || ''
      };
    }
    return {
      channel,
      text: byId(`out-${channel}_${suffix}`)?.textContent || ''
    };
  }

  // ------------------------------
  // Bindings
  // ------------------------------
  function bindCommon() {
    // Auth
    ensureNoThrow(() => byId('loginBtn')?.addEventListener('click', startLogin));
    ensureNoThrow(() => byId('loginBtn2')?.addEventListener('click', startLogin));
    ensureNoThrow(() => byId('logoutBtn')?.addEventListener('click', startLogout));
    ensureNoThrow(() => byId('logoutBtn2')?.addEventListener('click', startLogout));
    ensureNoThrow(() => byId('manageBilling')?.addEventListener('click', openBillingPortal));
    ensureNoThrow(() => byId('manageBilling2')?.addEventListener('click', openBillingPortal));

    // Checkout buttons (pricing cards): data-checkout="starter|creator|business"
    $$('[data-checkout]').forEach(btn => btn.addEventListener('click', () => {
      const plan = btn.getAttribute('data-checkout') || 'starter';
      openCheckout(plan);
    }));

    // Demo actions
    ensureNoThrow(() => byId('run_d')?.addEventListener('click', () => runDemo(false)));
    ensureNoThrow(() => byId('run-byok_d')?.addEventListener('click', () => runDemo(true)));
    ensureNoThrow(() => byId('clear_d')?.addEventListener('click', () => { const s = byId('source_d'); if (s) s.value=''; }));

    // Member actions
    ensureNoThrow(() => byId('run_m')?.addEventListener('click', () => runMember(false)));
    ensureNoThrow(() => byId('run-byok_m')?.addEventListener('click', () => runMember(true)));
    ensureNoThrow(() => byId('clear_m')?.addEventListener('click', () => { const s = byId('source_m'); if (s) s.value=''; }));
    ensureNoThrow(() => byId('save_m')?.addEventListener('click', saveBYOKToAccount));

    // Optimizer
    ensureNoThrow(() => byId('ao_run')?.addEventListener('click', () => runArticleOptimizer(false)));
    ensureNoThrow(() => byId('ao_run_byok')?.addEventListener('click', () => runArticleOptimizer(true)));
    ensureNoThrow(() => byId('ao_download_html')?.addEventListener('click', downloadOptimizedHTML));
    ensureNoThrow(() => byId('ao_copy_html')?.addEventListener('click', () => copyText(byId('ao_html')?.innerHTML || '')));

    // Scheduler
    ensureNoThrow(() => byId('sch_add')?.addEventListener('click', addSchedule));
    ensureNoThrow(() => byId('sch_refresh')?.addEventListener('click', refreshSchedules));
    ensureNoThrow(() => byId('sch_rrule_select')?.addEventListener('change', e => {
      const custom = e.target.value === 'CUSTOM';
      if (byId('sch_rrule_input')) byId('sch_rrule_input').toggleAttribute('disabled', !custom);
    }));

    // Analytics
    ensureNoThrow(() => byId('ana_range')?.addEventListener('change', e => refreshAnalytics(e.target.value || '7d')));

    // Presets
    ensureNoThrow(() => byId('addPreset')?.addEventListener('click', savePreset));

    // Team
    ensureNoThrow(() => byId('inviteBtn')?.addEventListener('click', inviteTeamMember));

    // Growth
    wireGrowth();

    // Channel optimizers & copy/publish & exports (both demo and member)
    const suffixes = ['d','m'];
    const channelsSimple = ['li','x','ig','tt','reddit','fb','quora','li-article'];
    const mapName = {
      li: 'linkedin', x: 'x', ig:'instagram', tt:'tiktok',
      reddit:'reddit', fb:'facebook', quora:'quora', 'li-article': 'li_article'
    };
    suffixes.forEach(suf => {
      // Optimize buttons
      channelsSimple.forEach(short => {
        const id = `optimize-${short}_${suf}`;
        const el = byId(id);
        if (el) el.addEventListener('click', () => {
          const channel = mapName[short];
          optimizeChannel(channel === 'li_article' ? 'li_article' : channel, suf);
        });
      });
      // Email optimize
      ensureNoThrow(() => byId(`optimize-em_${suf}`)?.addEventListener('click', () => optimizeChannel('email', suf)));

      // Copy buttons
      channelsSimple.forEach(short => {
        const outId = short === 'li-article' ? `out-li-article_${suf}` : `out-${mapName[short]}_${suf}`;
        const el = byId(`copy-${short}_${suf}`);
        if (el) el.addEventListener('click', () => copyText(byId(outId)?.textContent || ''));
      });
      ensureNoThrow(() => byId(`copy-em_${suf}`)?.addEventListener('click', () => {
        const subj = byId(`out-em-subj_${suf}`)?.textContent || '';
        const body = byId(`out-em-body_${suf}`)?.textContent || '';
        copyText(`Subject: ${subj}\n\n${body}`);
      }));

      // "Publish" buttons (open relevant destinations)
      ensureNoThrow(() => byId(`publish-li_${suf}`)?.addEventListener('click', () => window.open('https://www.linkedin.com/feed/', '_blank', 'noopener')));
      ensureNoThrow(() => byId(`publish-x_${suf}`)?.addEventListener('click', () => window.open('https://x.com/compose/post', '_blank', 'noopener')));
      ensureNoThrow(() => byId(`publish-ig_${suf}`)?.addEventListener('click', () => window.open('https://business.facebook.com/creatorstudio', '_blank', 'noopener')));
      ensureNoThrow(() => byId(`publish-tt_${suf}`)?.addEventListener('click', () => window.open('https://www.tiktok.com/upload?lang=en', '_blank', 'noopener')));
      ensureNoThrow(() => byId(`publish-reddit_${suf}`)?.addEventListener('click', () => window.open('https://www.reddit.com/submit', '_blank', 'noopener')));
      ensureNoThrow(() => byId(`publish-fb_${suf}`)?.addEventListener('click', () => window.open('https://www.facebook.com/', '_blank', 'noopener')));
      ensureNoThrow(() => byId(`publish-quora_${suf}`)?.addEventListener('click', () => window.open('https://www.quora.com/profile/', '_blank', 'noopener')));
      ensureNoThrow(() => byId(`publish-em_${suf}`)?.addEventListener('click', () => notify('Open your email client and paste the content.', 'info')));

      // Exports (Notion/Trello/Buffer)
      const exports = [
        ['li','linkedin'], ['x','x'], ['ig','instagram'], ['em','email'], ['ao','article']
      ];
      exports.forEach(([prefix, channel]) => {
        ensureNoThrow(() => byId(`${prefix}-notion`)?.addEventListener('click', () => {
          const payload = buildExportPayload(prefix, channel, suf);
          exportTo('notion', payload);
        }));
        ensureNoThrow(() => byId(`${prefix}-trello`)?.addEventListener('click', () => {
          const payload = buildExportPayload(prefix, channel, suf);
          exportTo('trello', payload);
        }));
        ensureNoThrow(() => byId(`${prefix}-buffer`)?.addEventListener('click', () => {
          const payload = buildExportPayload(prefix, channel, suf);
          exportTo('buffer', payload);
        }));
      });
    });

    // Integrations connect/disconnect
    ensureNoThrow(() => byId('connectNotion')?.addEventListener('click', () => connectIntegration('notion')));
    ensureNoThrow(() => byId('disconnectNotion')?.addEventListener('click', () => disconnectIntegration('notion')));
    ensureNoThrow(() => byId('connectTrello')?.addEventListener('click', () => connectIntegration('trello')));
    ensureNoThrow(() => byId('disconnectTrello')?.addEventListener('click', () => disconnectIntegration('trello')));
    ensureNoThrow(() => byId('connectBuffer')?.addEventListener('click', () => connectIntegration('buffer')));
    ensureNoThrow(() => byId('disconnectBuffer')?.addEventListener('click', () => disconnectIntegration('buffer')));

    // Reddit search helper (client-side suggestion fetch via worker)
    ensureNoThrow(() => byId('redditSearch_m')?.addEventListener('input', debounce(async (e) => {
      const q = e.target.value.trim();
      if (!q) { setHTML('redditSuggestions_m',''); return; }
      const r = await fetchJSON(`/api/search/reddit?q=${encodeURIComponent(q)}`);
      if (!r.ok) return;
      const items = r.data?.items || [];
      setHTML('redditSuggestions_m', items.slice(0,8).map(s => `<li class="px-2 py-1 rounded border inline-block mr-2 mb-2">r/${escapeHtml(s)}</li>`).join(''));
    }, 300)));

    // Export pack
    ensureNoThrow(() => byId('exportPack')?.addEventListener('click', async () => {
      const payload = { outputs: state.outputs_member, meta: { created: new Date().toISOString() } };
      const r = await fetchJSON('/api/export/pack', {
        method:'POST',
        headers:{'content-type':'application/json'},
        body: JSON.stringify(payload)
      });
      if (r.ok && r.data?.url) { window.open(r.data.url, '_blank','noopener'); }
      else notify(r.error || 'Could not export', 'error');
    }));
  }

  function debounce(fn, wait=300) {
    let t; return (...args) => { clearTimeout(t); t = setTimeout(() => fn.apply(null,args), wait); };
  }

  function buildExportPayload(prefix, channel, suf) {
    if (prefix === 'em' || channel === 'email') {
      return { channel: 'email',
        subject: byId(`out-em-subj_${suf}`)?.textContent || '',
        body: byId(`out-em-body_${suf}`)?.textContent || '',
        meta: { source: 'contentrepurpose' }
      };
    }
    if (prefix === 'ao' || channel === 'article') {
      return { channel: 'article',
        html: byId('ao_html')?.innerHTML || '',
        title: byId('sch_title')?.value || 'Article Draft',
        meta: { source: 'contentrepurpose' }
      };
    }
    return { channel,
      text: byId(`out-${channel}_${suf}`)?.textContent || '',
      meta: { source: 'contentrepurpose' }
    };
  }

  // ------------------------------
  // Boot
  // ------------------------------
  async function boot() {
    bindChannelPills();
    bindCommon();
    upsellModal(); // inject once

    await loadSession();
    applySessionUI();
    await refreshUsage();

    if (state.session?.user) {
      await checkIntegrations();
      await refreshSchedules();
      await refreshAnalytics('7d');
    } else {
      // Fill demo status once
      updateDemoQuotaUI();
    }
  }

  document.addEventListener('DOMContentLoaded', boot);
})();
</script>
